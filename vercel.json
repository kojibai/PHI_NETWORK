{
  "$schema": "https://openapi.vercel.sh/vercel.json",

  "functions": {
    "api/ssr.ts": {
      "includeFiles": "dist/server/**"
    }
  },

  "rewrites": [
    { "source": "/api/ssr", "destination": "/api/ssr.ts" },

    { "source": "/klok", "destination": "/klok.html" },
    { "source": "/klok.html", "destination": "/klok.html" },
    { "source": "/klok-core.js", "destination": "/klok-core.js" },

    { "source": "/sigil/new", "destination": "/sigil/new.html" },
    { "source": "/sigil/new.html", "destination": "/sigil/new.html" },
    { "source": "/sigil-core.js", "destination": "/sigil-core.js" },

    { "source": "/pulse", "destination": "/pulse.html" },
    { "source": "/pulse.html", "destination": "/pulse.html" },
    { "source": "/pulse-core.js", "destination": "/pulse-core.js" },

    { "source": "/verify/:slug", "destination": "/api/verify?slug=:slug" },

    { "source": "/verifier", "destination": "/verifier.html" },
    { "source": "/verifier.html", "destination": "/verifier.html" },
    { "source": "/verifier.inline.html", "destination": "/verifier.inline.html" },
    { "source": "/verifier-core.js", "destination": "/verifier-core.js" },

    { "source": "/sw.js", "destination": "/sw.js" },
    { "source": "/service-worker.js", "destination": "/service-worker.js" },

    { "source": "/", "destination": "/api/ssr" },

    {
      "source": "/:path((?!api/).*)",
      "has": [
        { "type": "header", "key": "accept", "value": "text/html.*" }
      ],
      "destination": "/api/ssr"
    }
  ],

  "headers": [
    {
      "source": "/assets/(.*)",
      "headers": [
        { "key": "Cache-Control", "value": "public, max-age=31536000, immutable" }
      ]
    },
    {
      "source": "/(.*)\\.(js|css|png|jpg|svg|ico|woff2?|wasm|zkey|r1cs|sym|json)",
      "headers": [
        { "key": "Cache-Control", "value": "public, max-age=31536000, immutable" }
      ]
    }
  ],

  "cleanUrls": true,
  "trailingSlash": false
}
