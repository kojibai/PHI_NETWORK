import{Gt as e,I as t,Kt as n,L as r,M as i,N as ee,O as te,S as a,Wt as o,_ as s,c as ne,f as re,h as ie,i as ae,jt as c,k as oe,l as se,m as ce,n as le,o as l,p as ue,pi as de,q as fe,r as u,s as pe,t as me,u as he,v as d,x as f,yi as p}from"./index-zEW0b4Lm.js";import{i as ge,n as _e}from"./webauthnKAS-CP3Mi5Qe.js";import{t as ve}from"./VerifierFrame-gn6qzLFb.js";import"./browser-BJHi3vOF.js";import{n as ye,t as be}from"./useValuation-Dz4oxi16.js";import{n as xe,t as Se}from"./verifySigil-DXDkjQSR.js";var m=p(de(),1),h=p(n(),1);function Ce(e){if(e==null)return`‚Äî`;if(typeof e==`string`)return e;try{return JSON.stringify(e,null,2)}catch{return String(e)}}async function we(e){return(await f(e)).toLowerCase()}function Te(e){if(typeof e!=`string`)return e;let t=e.trim();if(!t||!(t.startsWith(`{`)||t.startsWith(`[`)))return e;try{return JSON.parse(t)}catch{return e}}function g(e){return typeof e==`object`&&!!e}function Ee(e){if(!g(e))return null;let t=typeof e.originalAmount==`number`&&Number.isFinite(e.originalAmount)?e.originalAmount:null;if(t==null)return null;let n=(Array.isArray(e.debits)?e.debits:[]).reduce((e,t)=>{if(!g(t))return e;let n=t.amount;return typeof n!=`number`||!Number.isFinite(n)||n<=0?e:e+n},0);return{originalAmount:t,remaining:Math.max(0,t-n)}}function _(e){if(typeof e==`number`)return!Number.isFinite(e)||Math.abs(e)<1e-12?null:Math.abs(e);if(typeof e==`string`){let t=Number(e);if(!Number.isNaN(t)&&Math.abs(t)>=1e-12)return Math.abs(t)}return null}function De(e){if(!g(e))return null;let t=[e],n=e.feed,r=e.preview,i=e.meta;g(n)&&t.push(n),g(r)&&t.push(r),g(i)&&t.push(i);for(let e of t){let t=_(e.transferAmountPhi)??_(e.transferPhi)??_(e.amountPhi)??_(e.phiAmount)??_(e.childAllocationPhi)??_(e.branchBasePhi)??_(e.valuePhi)??_(e.value);if(t!=null)return t}return null}function Oe(e){if(!g(e))return null;let t=e.receiveSig;return u(t)?t:null}function ke(){if(typeof window>`u`)return``;let e=window.location.pathname||``,t=window.location.hash||``,n=e.match(/\/verify\/([^/?#]+)/);if(n?.[1])return n[1];let r=t.match(/\/verify\/([^/?#]+)/);return r?.[1]?r[1]:``}function v(e){return!g(e)||e.v!==`KPV-1`||typeof e.pulse!=`number`||!Number.isFinite(e.pulse)||typeof e.chakraDay!=`string`||typeof e.kaiSignature!=`string`||typeof e.phiKey!=`string`||typeof e.verifierSlug!=`string`?null:e}function Ae(e){if(!g(e))return null;let t=v(e.proofCapsule);return t?{proofCapsule:t,capsuleHash:typeof e.capsuleHash==`string`?e.capsuleHash:void 0,svgHash:typeof e.svgHash==`string`?e.svgHash:void 0,bundleHash:typeof e.bundleHash==`string`?e.bundleHash:void 0,verifierUrl:typeof e.verifierUrl==`string`?e.verifierUrl:void 0,shareUrl:typeof e.shareUrl==`string`?e.shareUrl:void 0,authorSig:e.authorSig,zkPoseidonHash:typeof e.zkPoseidonHash==`string`?e.zkPoseidonHash:void 0,zkProof:`zkProof`in e?e.zkProof:void 0,proofHints:`proofHints`in e?e.proofHints:void 0,zkPublicInputs:`zkPublicInputs`in e?e.zkPublicInputs:void 0}:null}function je(){if(typeof window>`u`)return null;let e=new URLSearchParams(window.location.search),t=e.get(`r`)??e.get(`receipt`);if(!t)return null;try{let e=new TextDecoder().decode(s(t));return Ae(JSON.parse(e))}catch{return null}}function Me(e){if(!e.trim().startsWith(`{`))return null;try{return Ae(JSON.parse(e))}catch{return null}}function y(e){return d(new TextEncoder().encode(e))}function Ne(e,t){let n=e||`/verify`,r=new URL(n,typeof window<`u`?window.location.origin:`http://localhost`);return r.searchParams.set(`r`,y(t)),r.toString()}async function Pe(e){return await new Promise((t,n)=>{let r=new FileReader;r.onerror=()=>n(Error(`Failed to read file.`)),r.onload=()=>t(String(r.result??``)),r.readAsText(e)})}function b(e,t=18,n=14){let r=(e||``).trim();return r?r.length<=t+n+3?r:`${r.slice(0,t)}‚Ä¶${r.slice(r.length-n)}`:`‚Äî`}function Fe(e){return Array.from(e).map(e=>e.toString(16).padStart(2,`0`)).join(``)}function Ie(e){try{return Fe(s(e.challenge))}catch{return null}}function Le(e){let t=(e.name||``).toLowerCase(),n=(e.type||``).toLowerCase();return t.endsWith(`.svg`)||n===`image/svg+xml`}async function Re(e){let t=e.trim();if(!t)return!1;try{if(navigator.clipboard?.writeText)return await navigator.clipboard.writeText(t),!0}catch{}try{let e=document.createElement(`textarea`);e.value=t,e.setAttribute(`readonly`,``),e.style.position=`fixed`,e.style.opacity=`0`,e.style.pointerEvents=`none`,document.body.appendChild(e),e.select(),e.setSelectionRange(0,e.value.length);let n=document.execCommand(`copy`);return document.body.removeChild(e),n}catch{return!1}}function x(e,t,n){if(typeof document>`u`||!n)return;let r=`meta[${e}="${t}"]`,i=document.head?.querySelector(r);i||(i=document.createElement(`meta`),i.setAttribute(e,t),document.head?.appendChild(i)),i.setAttribute(`content`,n)}function ze(){return(0,h.jsxs)(`svg`,{className:`mark`,viewBox:`0 0 24 24`,"aria-hidden":`true`,focusable:`false`,children:[(0,h.jsx)(`path`,{d:`M12 2.25 20.25 7v10L12 21.75 3.75 17V7L12 2.25Z`,fill:`none`,stroke:`currentColor`,strokeWidth:`1.4`,opacity:`0.95`}),(0,h.jsx)(`circle`,{cx:`12`,cy:`12`,r:`2.2`,fill:`currentColor`,opacity:`0.95`}),(0,h.jsx)(`path`,{d:`M7.2 12c0-2.65 2.15-4.8 4.8-4.8`,fill:`none`,stroke:`currentColor`,strokeWidth:`1.4`,strokeLinecap:`round`,opacity:`0.55`})]})}function Be(){return(0,h.jsxs)(`svg`,{className:`mark`,viewBox:`0 0 24 24`,"aria-hidden":`true`,focusable:`false`,children:[(0,h.jsx)(`path`,{d:`M9.5 7.5a2.5 2.5 0 0 1 4 0l.7 1a3.6 3.6 0 0 0 2.3 1.4l1.2.2a2.5 2.5 0 0 1 0 4.9l-1.2.2a3.6 3.6 0 0 0-2.3 1.4l-.7 1a2.5 2.5 0 0 1-4 0l-.7-1a3.6 3.6 0 0 0-2.3-1.4l-1.2-.2a2.5 2.5 0 0 1 0-4.9l1.2-.2a3.6 3.6 0 0 0 2.3-1.4l.7-1Z`,fill:`none`,stroke:`currentColor`,strokeWidth:`1.4`,opacity:`0.95`}),(0,h.jsx)(`path`,{d:`M8.7 12.2 11 14.4l4.6-4.7`,fill:`none`,stroke:`currentColor`,strokeWidth:`1.6`,strokeLinecap:`round`,strokeLinejoin:`round`})]})}function S(e){return(0,h.jsx)(`button`,{type:`button`,className:e.kind===`primary`?`vbtn vbtn--primary`:`vbtn`,title:e.title,"aria-label":e.ariaLabel??e.title,onClick:e.onClick,disabled:e.disabled,children:(0,h.jsx)(`span`,{className:`vbtn-ic`,"aria-hidden":`true`,children:e.icon})})}function C(e){return(0,h.jsxs)(`button`,{type:`button`,role:`tab`,"aria-selected":e.active,className:e.active?`vtab active`:`vtab`,onClick:e.onClick,title:e.title,"aria-label":e.title,children:[(0,h.jsx)(`span`,{className:`vtab-ic`,"aria-hidden":`true`,children:e.icon}),(0,h.jsx)(`span`,{className:`vtab-txt`,children:e.text})]})}function Ve(e){let t=e.kind===`ok`?`ok`:e.kind===`fail`?`fail`:e.kind===`busy`?`busy`:`idle`,n=e.kind===`ok`;return(0,h.jsxs)(`div`,{className:`official`,"data-kind":t,"aria-live":`polite`,children:[(0,h.jsxs)(`div`,{className:`official-top`,children:[(0,h.jsx)(`div`,{className:`official-ring`,"aria-hidden":`true`,children:n?(0,h.jsx)(`span`,{className:`official-check`,children:`‚úì`}):null}),(0,h.jsx)(`div`,{className:`official-title`,children:e.title})]}),e.subtitle?(0,h.jsx)(`div`,{className:`official-sub`,children:e.subtitle}):null]})}function w(e){let t=e.state===`valid`?`‚úì`:e.state===`invalid`?`‚úï`:e.state===`busy`?`‚ü°`:e.state===`na`?`‚Äî`:`¬∑`,n=e.state===`valid`?`VERIFIED`:e.state===`invalid`?`INVALID`:e.state===`busy`?`CHECKING`:e.state===`na`?`N/A`:`ABSENT`;return(0,h.jsxs)(`div`,{className:`seal`,"data-state":e.state,title:e.detail??``,children:[(0,h.jsx)(`span`,{className:`seal-ic`,"aria-hidden":`true`,children:t}),(0,h.jsx)(`span`,{className:`seal-lbl`,children:e.label}),(0,h.jsx)(`span`,{className:`seal-txt`,children:n})]})}function T(e){return(0,h.jsxs)(`div`,{className:`mini`,children:[(0,h.jsx)(`div`,{className:`mini-k`,children:e.label}),(0,h.jsx)(`div`,{className:`mini-v mono`,title:e.title??e.value,children:e.value||`‚Äî`})]})}function He(e){return(0,h.jsxs)(`div`,{className:`vseal-value`,"aria-label":e.ariaLabel,children:[(0,h.jsx)(`div`,{className:`vseal-value-label`,children:e.label}),(0,h.jsx)(`div`,{className:`vseal-value-phi`,children:t(e.phiValue)}),(0,h.jsx)(`div`,{className:`vseal-value-usd`,children:e.usdValue==null?`‚Äî`:r(e.usdValue)})]})}function Ue(e){return e.open?(0,h.jsx)(`div`,{className:`vmodal-backdrop`,role:`dialog`,"aria-modal":`true`,"aria-label":e.title,onMouseDown:e.onClose,onClick:e.onClose,children:(0,h.jsxs)(`div`,{className:`vmodal`,onMouseDown:e=>e.stopPropagation(),onClick:e=>e.stopPropagation(),children:[(0,h.jsxs)(`div`,{className:`vmodal-head`,children:[(0,h.jsxs)(`div`,{className:`vmodal-head-left`,children:[(0,h.jsx)(`div`,{className:`vmodal-title`,children:e.title}),e.subtitle?(0,h.jsx)(`div`,{className:`vmodal-sub`,children:e.subtitle}):null]}),(0,h.jsx)(`button`,{type:`button`,className:`vmodal-close`,onClick:e.onClose,"aria-label":`Close`,title:`Close`,children:`√ó`})]}),(0,h.jsx)(`div`,{className:`vmodal-body`,children:e.children})]})}):null}function E(){let n=(0,m.useRef)(null),s=(0,m.useMemo)(()=>ke(),[]),l=(0,m.useMemo)(()=>Se(s),[s]),de=(0,m.useMemo)(()=>je(),[]),[u,d]=(0,m.useState)(`inhale`),[f,p]=(0,m.useState)(``),[g,_]=(0,m.useState)({status:`idle`}),[v,Ae]=(0,m.useState)(!1),[y,Fe]=(0,m.useState)(de),[E,We]=(0,m.useState)(null),[D,Ge]=(0,m.useState)(``),[O,Ke]=(0,m.useState)(``),[k,qe]=(0,m.useState)(``),[Je,Ye]=(0,m.useState)(``),[A,Xe]=(0,m.useState)(null),[Ze,j]=(0,m.useState)(``),[M,N]=(0,m.useState)(null),[Qe,P]=(0,m.useState)(null),[$e,F]=(0,m.useState)(`missing`),[et,I]=(0,m.useState)(!1),[tt,nt]=(0,m.useState)(!1),[rt,it]=(0,m.useState)(`missing`),[L,at]=(0,m.useState)(null),[ot,st]=(0,m.useState)(null),[R,ct]=(0,m.useState)(null),[lt,ut]=(0,m.useState)(!1),{pulse:dt}=ye(),ft=(0,m.useMemo)(()=>new URLSearchParams(typeof window<`u`?window.location.search:``),[]),z=(0,m.useMemo)(()=>{if(g.status!==`ok`)return null;let e=g.embedded,t=e.pulse??l.pulse??void 0;return{pulse:t,kaiPulse:t,beat:e.beat,stepIndex:e.stepIndex,frequencyHz:e.frequencyHz,chakraDay:e.chakraDay,chakraGate:e.chakraGate,kaiSignature:e.kaiSignature,userPhiKey:e.phiKey}},[g,l.pulse]),{valSeal:pt,livePrice:mt}=be({payload:z,urlSearchParams:ft,currentPulse:dt}),{usdPerPhi:ht}=(0,m.useMemo)(()=>{if(!z)return{usdPerPhi:0};try{return{usdPerPhi:e({meta:z,nowPulse:dt??fe(new Date),usd:100,currentStreakDays:0,lifetimeUsdSoFar:0},o).usdPerPhi??0}}catch{return{usdPerPhi:0}}},[z,dt]),gt=(0,m.useMemo)(()=>{if(!z)return null;let e=mt??pt?.valuePhi??null;return typeof e==`number`&&Number.isFinite(e)?e:null},[z,mt,pt]),_t=(0,m.useMemo)(()=>g.status===`ok`?Ee(g.embedded.raw)??Ee(A?.raw):null,[A?.raw,g]),vt=(0,m.useMemo)(()=>g.status===`ok`?De(g.embedded.raw)??De(A?.raw):null,[A?.raw,g]),B=_t?.remaining??vt??gt,V=_t?`balance`:vt==null?`live`:`embedded`,yt=(0,m.useMemo)(()=>B==null||!Number.isFinite(ht)||ht<=0?null:B*ht,[B,ht]),bt=V===`balance`?`BALANCE`:V===`embedded`?`GLYPH`:`LIVE`,xt=V===`balance`?`Glyph balance`:V===`embedded`?`Glyph embedded value`:`Live glyph valuation`,[St,Ct]=(0,m.useState)(!1),[wt,H]=(0,m.useState)(!1),[Tt,Et]=(0,m.useState)(!1),[Dt,Ot]=(0,m.useState)(!1),[kt,At]=(0,m.useState)(!1),[jt,Mt]=(0,m.useState)(``);m.useEffect(()=>{let e=document.documentElement,t=document.body;return e.classList.add(`verify-shell`),t.classList.add(`verify-shell`),()=>{e.classList.remove(`verify-shell`),t.classList.remove(`verify-shell`)}},[]),m.useEffect(()=>{let e=f.trim();if(!e){Mt(``);return}try{let t=new Blob([e],{type:`image/svg+xml`}),n=URL.createObjectURL(t);return Mt(n),()=>{URL.revokeObjectURL(n)}}catch{Mt(``);return}},[f]),m.useEffect(()=>{let e=!0,t=f.trim();if(!t){Ye(``);return}let n=new TextEncoder().encode(te(t));return(async()=>{let t=await we(n);e&&Ye(t)})(),()=>{e=!1}},[f]),m.useEffect(()=>{if(!Ze)return;let e=window.setTimeout(()=>j(``),2400);return()=>window.clearTimeout(e)},[Ze]),m.useEffect(()=>{if(typeof window>`u`)return;let e=g.status===`ok`?`VERIFIED`:g.status===`error`?`FAILED`:`STANDBY`,t=window.location.origin,n=l.raw||s||``,r=new URL(`${t}/verify/${encodeURIComponent(n)}`),i=new URL(`${t}/api/og/verify`);i.searchParams.set(`slug`,n),i.searchParams.set(`status`,e.toLowerCase()),g.status===`ok`&&(i.searchParams.set(`pulse`,String(g.embedded.pulse??l.pulse??``)),i.searchParams.set(`phiKey`,g.derivedPhiKey??``),g.embedded.chakraDay&&i.searchParams.set(`chakraDay`,g.embedded.chakraDay),M!=null&&i.searchParams.set(`kas`,M?`1`:`0`),L!=null&&i.searchParams.set(`g16`,L?`1`:`0`)),document.title=`Proof of Breath‚Ñ¢ ‚Äî ${e}`,x(`property`,`og:title`,`Proof of Breath‚Ñ¢ ‚Äî ${e}`),x(`property`,`og:description`,`Proof of Breath‚Ñ¢ ‚Ä¢ ${e} ‚Ä¢ Pulse ${l.pulse??`‚Äî`}`),x(`property`,`og:url`,r.toString()),x(`property`,`og:image`,i.toString()),x(`name`,`twitter:card`,`summary_large_image`),x(`name`,`twitter:title`,`Proof of Breath‚Ñ¢ ‚Äî ${e}`),x(`name`,`twitter:description`,`Proof of Breath‚Ñ¢ ‚Ä¢ ${e} ‚Ä¢ Pulse ${l.pulse??`‚Äî`}`),x(`name`,`twitter:image`,i.toString())},[M,g,l.pulse,l.raw,s,L]);let U=(0,m.useMemo)(()=>A||(g.status!==`ok`||!g.embedded.zkProof&&!g.embedded.zkPublicInputs&&!g.embedded.zkPoseidonHash&&!g.embedded.proofHints?null:{zkPoseidonHash:g.embedded.zkPoseidonHash,zkProof:g.embedded.zkProof,zkPublicInputs:g.embedded.zkPublicInputs,proofHints:g.embedded.proofHints}),[A,g]),W=(0,m.useMemo)(()=>U?.zkProof?Ce(U.zkProof):``,[U]),G=(0,m.useMemo)(()=>U?.zkPublicInputs?Ce(U.zkPublicInputs):``,[U]),K=(0,m.useMemo)(()=>U?.proofHints?Ce(U.proofHints):``,[U]),q=(0,m.useMemo)(()=>E?he(E.pulse,E.kaiSignature):``,[E]),J=(0,m.useMemo)(()=>typeof window>`u`?``:window.location.href,[s]),Y=(0,m.useCallback)(async(e,t)=>{let n=(e||``).trim();if(n)try{if(!navigator.clipboard?.writeText){j(`Clipboard unavailable. Use manual copy.`);return}await navigator.clipboard.writeText(n),j(`${t} remembered.`)}catch(e){j(`Remember failed. Use manual copy.`),console.error(e)}},[]),Nt=(0,m.useCallback)(async e=>{if(!Le(e)){_({status:`error`,message:`Upload a sealed .svg (embedded <metadata> JSON).`,slug:l});return}p(await Pe(e)),_({status:`idle`}),j(``)},[l]),Pt=(0,m.useCallback)(e=>{if(!e||e.length===0)return;let t=Array.from(e).find(Le);if(!t){_({status:`error`,message:`Drop/select a sealed .svg file.`,slug:l});return}Nt(t)},[Nt,l]),Ft=(0,m.useCallback)(async()=>{let e=f.trim();if(!e){_({status:`error`,message:`Inhale or paste the sealed SVG (Œ¶Key).`,slug:l});return}let t=Me(e);if(t){Fe(t),p(``),_({status:`idle`}),j(`Receipt loaded.`);return}Ae(!0);try{let t=await xe(l,e);_(t),t.status===`ok`?(F(`missing`),I(!0)):I(!1)}finally{Ae(!1)}},[l,f]);m.useEffect(()=>{let e=!0;return(async()=>{if(g.status!==`ok`){We(null),Ge(``),Ke(``),qe(``),Xe(null),N(null),j(``);return}if(y&&!f.trim()){We(y.proofCapsule),Ke(y.svgHash??``),Ge(y.capsuleHash??``),qe(y.bundleHash??``),Xe({proofCapsule:y.proofCapsule,svgHash:y.svgHash,capsuleHash:y.capsuleHash,bundleHash:y.bundleHash,shareUrl:y.shareUrl,verifierUrl:y.verifierUrl,authorSig:y.authorSig,zkPoseidonHash:y.zkPoseidonHash,zkProof:y.zkProof,proofHints:y.proofHints,zkPublicInputs:y.zkPublicInputs}),N(null);return}let t=g.embedded.kaiSignature??``,n=g.embedded.pulse??g.slug.pulse??0,r={v:`KPV-1`,pulse:n,chakraDay:ie(g.embedded.chakraDay??``)??`Crown`,kaiSignature:t,phiKey:g.derivedPhiKey,verifierSlug:se(n,t)},te=await ce(f),a=i(f),o=a?.proofCapsule??r,s=await ue(o),ae=await re(ne(a?.raw&&typeof a.raw==`object`&&a.raw!==null?{...a.raw,svgHash:te,capsuleHash:s,proofCapsule:o}:{hashAlg:a?.hashAlg??`sha256`,canon:a?.canon??`JCS`,proofCapsule:o,capsuleHash:s,svgHash:te,shareUrl:a?.shareUrl,verifierUrl:a?.verifierUrl,zkPoseidonHash:a?.zkPoseidonHash,zkProof:a?.zkProof,proofHints:a?.proofHints,zkPublicInputs:a?.zkPublicInputs,authorSig:a?.authorSig??null})),c=a?.authorSig,oe=null;c&&(oe=ee(c)?await ge(Ie(c)??ae,c):!1),e&&(We(o),Ke(te),Ge(s),qe(ae),Xe(a),N(oe))})(),()=>{e=!1}},[g,y,l.raw,f]),m.useEffect(()=>{let e=!0;if(!y||f.trim())return;let t=y.proofCapsule,n={proofCapsule:t,svgHash:y.svgHash,capsuleHash:y.capsuleHash,bundleHash:y.bundleHash,shareUrl:y.shareUrl,verifierUrl:y.verifierUrl,authorSig:y.authorSig,zkPoseidonHash:y.zkPoseidonHash,zkProof:y.zkProof,proofHints:y.proofHints,zkPublicInputs:y.zkPublicInputs};return(async()=>{let r=await c(t.kaiSignature),i=l.pulse==null?null:l.pulse===t.pulse,ee=l.shortSig==null?null:l.shortSig===t.kaiSignature.slice(0,l.shortSig.length),te=t.phiKey?r===t.phiKey:null;if(!e)return;let a={hasSignature:!0,slugPulseMatches:i,slugShortSigMatches:ee,derivedPhiKeyMatchesEmbedded:te},o=a.slugPulseMatches===!1||a.slugShortSigMatches===!1||a.derivedPhiKeyMatchesEmbedded===!1,s={pulse:t.pulse,chakraDay:t.chakraDay,kaiSignature:t.kaiSignature,phiKey:t.phiKey,proofCapsule:t};_(o?{status:`error`,message:`Verification failed: one or more checks did not match.`,slug:l,embedded:s,derivedPhiKey:r,checks:a}:{status:`ok`,slug:l,embedded:s,derivedPhiKey:r,checks:a}),Xe(n),We(t),Ge(y.capsuleHash??``),Ke(y.svgHash??``),qe(y.bundleHash??``)})(),()=>{e=!1}},[y,l,f]),m.useEffect(()=>{if(g.status!==`ok`||!k){ct(null),P(null);return}let e=Oe(A?.raw??g.embedded.raw);if(e){ct(e);return}ct(null),P(null)},[g.status,k,A?.raw]),m.useEffect(()=>{let e=!0;if(!R||!k){P(null);return}return(async()=>{let t=R.binds.bundleHash;if(!t){e&&P(!1);return}let{challengeBytes:n}=await me(`receive`,t,R.nonce),r=await ae({assertion:R.assertion,expectedChallenge:n,pubKeyJwk:R.pubKeyJwk,expectedCredId:R.credId});e&&P(r)})(),()=>{e=!1}},[R,k]),m.useEffect(()=>{let e=!0;if(!A?.authorSig||!k||M!==null)return;let t=A.authorSig;return(async()=>{if(!ee(t)){e&&N(!1);return}let n=await ge(Ie(t)??k,t);e&&N(n)})(),()=>{e=!1}},[M,k,A?.authorSig]),m.useEffect(()=>{f.trim()||(F(`missing`),I(!1))},[f]),m.useEffect(()=>{if(!f.trim()){it(`missing`);return}let e=y?.svgHash??A?.svgHash??``;if(!e){it(`missing`);return}Je&&it(Je===e)},[A?.svgHash,y?.svgHash,Je,f]),m.useEffect(()=>{let e=!0;return(async()=>{if(!U?.zkProof||!U?.zkPublicInputs){e&&at(null);return}if(!ot)try{let t=await fetch(`/zk/verification_key.json`,{cache:`no-store`});if(!t.ok)return;let n=await t.json();if(!e)return;st(n);return}catch{return}let t=Te(U.zkProof),n=Te(U.zkPublicInputs),r=await oe({proof:t,publicSignals:Array.isArray(n)||typeof n==`object`?n:[n],vkey:ot??void 0,fallbackVkey:ot??void 0});e&&at(r)})(),()=>{e=!1}},[U,ot]);let It=(0,m.useCallback)(async(e,t)=>{if(!tt){nt(!0);try{if(!_e()){F(!1),j(`WebAuthn is not available in this browser. Please verify on a device with passkeys enabled.`);return}let{challengeBytes:n}=await me(`unlock`,t),r;try{r=await le({challenge:n,allowCredIds:[e.credId],preferInternal:!0})}catch{r=await le({challenge:n,preferInternal:!0})}let i=await ae({assertion:r,expectedChallenge:n,pubKeyJwk:e.pubKeyJwk,expectedCredId:e.credId});F(i),i||j(`Identity verification failed.`)}catch{F(!1),j(`Identity verification canceled.`)}finally{nt(!1),I(!1)}}},[tt]);m.useEffect(()=>{if(!et)return;if(!f.trim()){I(!1);return}let e=A?.authorSig;if(!e||!ee(e)){F(`missing`),I(!1);return}k&&It(e,k)},[It,k,A?.authorSig,et,f]);let Lt=(0,m.useMemo)(()=>v?{kind:`busy`,title:`SEALING`,subtitle:`Deterministic proof rails executing.`}:g.status===`ok`?{kind:`ok`,title:`PROOF OF BREATH‚Ñ¢`,subtitle:`Human-origin seal affirmed.`}:g.status===`error`?{kind:`fail`,title:`REJECTED`,subtitle:`Inhale a sealed Œ¶Key, then verify.`}:{kind:`idle`,title:`STANDBY`,subtitle:`Inhale a Œ¶Key to begin.`},[v,g.status]),Rt=(0,m.useMemo)(()=>g.status===`ok`?String(g.embedded.pulse??l.pulse??0):String(l.pulse??0),[g,l.pulse]),zt=(0,m.useMemo)(()=>g.status===`ok`&&g.derivedPhiKey||`‚Äî`,[g]),Bt=(0,m.useMemo)(()=>v?`busy`:A?.authorSig?M===null?`na`:M?`valid`:`invalid`:`off`,[v,A?.authorSig,M]),Vt=(0,m.useMemo)(()=>v?`busy`:U?.zkPoseidonHash?L===null?`na`:L?`valid`:`invalid`:`off`,[v,U?.zkPoseidonHash,L]),Ht=!!f.trim(),Ut=y?.svgHash??A?.svgHash??``,Wt=!!(A?.authorSig&&ee(A.authorSig)),Gt=!Ht||!Wt?`Not present`:tt?`Aligning‚Ä¶`:$e===!0?`Present (Verified)`:$e===!1?`Not verified`:`Alignment required`,Kt=rt===!0?`Present (Verified)`:rt===!1?`Failed`:Ht?Ut?`Not present`:`No reference hash`:`Not present`,qt=(0,m.useMemo)(()=>R?R.credId:``,[R]),Jt=(0,m.useMemo)(()=>R?R.nonce:``,[R]),Yt=(0,m.useMemo)(()=>R?.binds.bundleHash?R.binds.bundleHash:k||``,[R,k]),X=(0,m.useMemo)(()=>E?JSON.stringify({hashAlg:pe,canon:`JCS`,proofCapsule:E,capsuleHash:D,svgHash:O,bundleHash:k,shareUrl:A?.shareUrl??null,verifierUrl:q,authorSig:A?.authorSig??null,zkPoseidonHash:U?.zkPoseidonHash??null,zkProof:U?.zkProof??null,proofHints:U?.proofHints??null,zkPublicInputs:U?.zkPublicInputs??null},null,2):``,[E,D,O,k,A,q,U]),Xt=(0,m.useMemo)(()=>{let e=f.trim();if(!e)return``;let t=e.split(`
`);return t.slice(0,Math.min(t.length,8)).join(`
`)},[f]),Z=g.status===`ok`?g.embedded.pulse??l.pulse??0:l.pulse??0,Zt=g.status===`ok`?g.embedded.kaiSignature??l.shortSig??`unknown`:l.shortSig??`unknown`,Q=g.status===`ok`?g.derivedPhiKey:`‚Äî`,Qt=g.status===`ok`?g.embedded.chakraDay:void 0,$t=g.status===`ok`?`VERIFIED`:g.status===`error`?`FAILED`:`STANDBY`,en=Q&&Q!==`‚Äî`?b(Q,12,10):`‚Äî`,tn=Bt===`valid`?`‚úÖ`:`‚ùå`,nn=Vt===`valid`?`‚úÖ`:`‚ùå`,$=(0,m.useMemo)(()=>{if(!E)return``;let e={hashAlg:pe,canon:`JCS`,proofCapsule:E,capsuleHash:D,verifierUrl:q||J};return O&&(e.svgHash=O),k&&(e.bundleHash=k),A?.shareUrl&&(e.shareUrl=A.shareUrl),A?.authorSig&&(e.authorSig=A.authorSig),A?.zkProof&&(e.zkProof=A.zkProof),A?.proofHints&&(e.proofHints=A.proofHints),A?.zkPublicInputs&&(e.zkPublicInputs=A.zkPublicInputs),U?.zkPoseidonHash&&(e.zkPoseidonHash=U.zkPoseidonHash,e.zkVerified=!!L,e.zkScheme=`groth16-poseidon`),a(e)},[k,D,J,A?.shareUrl,E,q,O,U?.zkPoseidonHash,L]),rn=(0,m.useMemo)(()=>{if(!$)return``;let e=q||J;return e?Ne(e,$):``},[J,q,$]),an=(0,m.useCallback)(async()=>{let e=rn||q||J,t=`Proof of Breath‚Ñ¢ ‚Äî ${$t}`,n=`${$t} ‚Ä¢ Pulse ${Z} ‚Ä¢ Œ¶Key ${en} ‚Ä¢ KAS ${tn} ‚Ä¢ G16 ${nn}`;if(navigator.share)try{await navigator.share({title:t,text:n,url:e});return}catch(e){if(e instanceof Error&&e.name===`AbortError`)return}j(await Re(e)?`Link Remembered.`:`Remember failed. Use manual remember.`)},[J,q,nn,tn,en,rn,$t,Z]),on=(0,m.useCallback)(async()=>{$&&j(await Re($)?`Proof JSON remembered.`:`Remember failed. Use manual remember.`)},[$]),sn=u===`inhale`?`Inhale`:u===`capsule`?`Vessel`:u===`proof`?`Proof`:u===`zk`?`ZK`:`Audit`,cn=(0,m.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),ut(!0)},[]),ln=(0,m.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),ut(!1)},[]),un=(0,m.useCallback)(e=>{e.preventDefault(),e.stopPropagation(),ut(!1),Pt(e.dataTransfer?.files)},[Pt]);return(0,h.jsxs)(`div`,{className:`vapp`,role:`application`,"aria-label":`‚ò§Kai Sigil-Glyph Attestation`,children:[Ze?(0,h.jsx)(`button`,{type:`button`,className:`vtoast vtoast-floating`,onClick:()=>j(``),"aria-label":`Dismiss notice`,title:`Dismiss`,children:Ze}):null,(0,h.jsxs)(`header`,{className:`vhead`,children:[(0,h.jsxs)(`div`,{className:`vhead-left`,children:[(0,h.jsxs)(`div`,{className:`vbrand`,children:[(0,h.jsx)(`div`,{className:`vtitle`,children:`‚ò§Kai Sigil-Glyph Attestation`}),(0,h.jsx)(`div`,{className:`vsub`,children:`Sovereign proof of human origin ‚Äî ‚ò§Kai-Signature ‚Üí Œ¶-Key.`})]}),(0,h.jsxs)(`div`,{className:`vlink`,children:[(0,h.jsx)(`span`,{className:`vlink-k`,children:`Path`}),(0,h.jsxs)(`code`,{className:`vlink-v mono`,children:[`/verify/`,l.raw||`‚Äî`]})]})]}),(0,h.jsxs)(`div`,{className:`vhead-right`,children:[(0,h.jsxs)(`div`,{className:`vhead-top`,"aria-label":`Primary verification`,children:[jt?(0,h.jsx)(`div`,{className:`vsigil-thumb`,"aria-label":`Uploaded sigil preview`,title:`Uploaded sigil preview`,children:(0,h.jsx)(`img`,{className:`vsigil-img`,src:jt,alt:`Uploaded sigil`})}):null,(0,h.jsx)(Ve,{kind:Lt.kind,title:Lt.title,subtitle:Lt.subtitle})]}),(0,h.jsxs)(`div`,{className:`vseals`,"aria-label":`Sovereign seals`,children:[(0,h.jsx)(w,{label:`KAS`,state:Bt,detail:A?.authorSig?`Author seal (WebAuthn KAS)`:`No author seal present`}),(0,h.jsx)(w,{label:`G16`,state:Vt,detail:U?.zkPoseidonHash?`Groth16 + Poseidon rail`:`No ZK rail present`}),g.status===`ok`&&B!=null?(0,h.jsx)(He,{phiValue:B,usdValue:yt,label:bt,ariaLabel:xt}):null]}),(0,h.jsxs)(`div`,{className:`vkpis`,"aria-label":`Primary identifiers`,children:[(0,h.jsx)(T,{label:`Pulse`,value:Rt}),(0,h.jsx)(T,{label:`Œ¶-Key`,value:zt===`‚Äî`?`‚Äî`:b(zt,12,10),title:zt})]}),E?(0,h.jsxs)(`div`,{className:`vreceipt-row`,"aria-label":`Proof actions`,children:[(0,h.jsx)(`div`,{className:`vreceipt-label`,children:`Proof`}),(0,h.jsxs)(`div`,{className:`vreceipt-actions`,children:[(0,h.jsx)(`button`,{type:`button`,className:`vbtn vbtn--ghost`,onClick:()=>void an(),children:`‚û¶`}),(0,h.jsx)(`button`,{type:`button`,className:`vbtn vbtn--ghost`,onClick:()=>void on(),children:`üí†`})]})]}):null]})]}),(0,h.jsxs)(`div`,{className:`vbody`,children:[(0,h.jsxs)(`section`,{className:`vpanel`,role:`tabpanel`,"aria-label":`Active panel`,children:[u===`inhale`?(0,h.jsxs)(`div`,{className:`vcard`,"data-panel":`inhale`,children:[(0,h.jsxs)(`div`,{className:`vcard-head`,children:[(0,h.jsx)(`div`,{className:`vcard-title`,children:`Inhale Œ¶Key`}),(0,h.jsx)(`div`,{className:`vcard-sub`,children:`Tap to inhale a sealed Œ¶Key. Deep payloads open in Expanded Views.`})]}),(0,h.jsxs)(`div`,{className:`vcard-body vfit`,children:[(0,h.jsxs)(`div`,{className:lt?`vdropzone is-drag`:`vdropzone`,onDragOver:cn,onDragEnter:cn,onDragLeave:ln,onDrop:un,children:[(0,h.jsx)(`input`,{ref:n,className:`vfile`,type:`file`,accept:`.svg,image/svg+xml`,onChange:e=>{Pt(e.currentTarget.files),e.currentTarget.value=``}}),(0,h.jsxs)(`div`,{className:`vgrid-2 vgrid-2--inhale`,children:[(0,h.jsxs)(`div`,{className:`vcontrol`,"aria-label":`Inhale controls`,children:[(0,h.jsxs)(`button`,{type:`button`,className:`vdrop`,"aria-label":`Inhale sealed Œ¶Key (SVG)`,title:`Inhale sealed Œ¶Key (.svg)`,onClick:()=>n.current?.click(),children:[(0,h.jsx)(`span`,{className:`vdrop-ic`,"aria-hidden":`true`,children:(0,h.jsx)(`img`,{className:`vphi-ic`,src:`/phi.svg`,alt:``,"aria-hidden":`true`})}),(0,h.jsx)(`span`,{className:`vdrop-txt`,children:`Inhale`}),(0,h.jsxs)(`span`,{className:`vdrop-mark`,"aria-label":`PhiKey mark`,children:[(0,h.jsx)(`img`,{className:`vphi`,src:`/phi.svg`,alt:`Œ¶`}),(0,h.jsx)(`span`,{className:`vdrop-mark-txt`,children:`Œ¶Key`})]})]}),(0,h.jsxs)(`div`,{className:`vcontrol-row`,"aria-label":`Quick actions`,children:[(0,h.jsx)(S,{icon:`‚ü°`,title:v?`Verifying‚Ä¶`:`Verify`,ariaLabel:`Verify`,onClick:()=>void Ft(),disabled:v,kind:`primary`}),(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (paste/edit)`,ariaLabel:`Focus View (paste/edit)`,onClick:()=>Ct(!0),disabled:!f.trim()}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Œ¶Key`,ariaLabel:`Remember Œ¶Key`,onClick:()=>void Y(f,`Œ¶Key`),disabled:!f.trim()}),(0,h.jsx)(S,{icon:`‚®Ø`,title:`Clear`,ariaLabel:`Clear`,onClick:()=>{p(``),Fe(null),_({status:`idle`}),j(``)},disabled:!f.trim()})]}),(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--2`,"aria-label":`Attestation status`,children:[(0,h.jsx)(T,{label:`Identity`,value:Gt}),(0,h.jsx)(T,{label:`Sigil-Glyph`,value:Kt})]}),(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--2`,"aria-label":`Quick readout`,children:[(0,h.jsx)(T,{label:`Inhaled`,value:f.trim()?`true`:`false`}),(0,h.jsx)(T,{label:`Attestation`,value:A?`present`:`‚Äî`})]})]}),(0,h.jsxs)(`div`,{className:`vconsole`,"aria-label":`Œ¶Key preview`,children:[(0,h.jsx)(`pre`,{className:`vpre`,children:(0,h.jsx)(`code`,{className:`mono`,children:Xt||`inhale a sealed Œ¶Key (.SVG) to begin‚Ä¶`})}),(0,h.jsxs)(`div`,{className:`vconsole-foot`,children:[(0,h.jsxs)(`div`,{className:`vchip`,title:`Sovereign verification rail`,children:[`Sovereign ¬∑ `,pe,` ¬∑ `,`JCS`]}),(0,h.jsxs)(`div`,{className:`vactions`,"aria-label":`Console actions`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View`,ariaLabel:`Focus View`,onClick:()=>Ct(!0),disabled:!f.trim()}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Œ¶Key`,ariaLabel:`Remember Œ¶Key`,onClick:()=>void Y(f,`Œ¶Key`),disabled:!f.trim()})]})]})]})]}),(0,h.jsx)(`div`,{className:`vdropzone-hint`,"aria-hidden":`true`,children:`Drag & drop Œ¶Key anywhere in this panel`})]}),g.status===`error`?(0,h.jsx)(`div`,{className:`verror`,children:g.message??`Not verified.`}):null]})]}):null,u===`capsule`?(0,h.jsxs)(`div`,{className:`vcard`,"data-panel":`capsule`,children:[(0,h.jsxs)(`div`,{className:`vcard-head`,children:[(0,h.jsx)(`div`,{className:`vcard-title`,children:`Proof Vessel`}),(0,h.jsx)(`div`,{className:`vcard-sub`,children:`Determinate identity seal: ‚ò§Kai (pulse) + spiral (chakra) day + ‚ò§Kai-Signature ‚Üí Œ¶-Key.`})]}),(0,h.jsx)(`div`,{className:`vcard-body vfit`,children:(0,h.jsxs)(`div`,{className:`vgrid-2 vgrid-2--capsule`,children:[(0,h.jsx)(`div`,{className:`vframe-wrap`,children:(0,h.jsx)(ve,{pulse:Z,kaiSignature:Zt,phiKey:Q,chakraDay:Qt,compact:!0})}),(0,h.jsxs)(`div`,{className:`vstack`,children:[(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--3`,"aria-label":`Slug and embed checks`,children:[(0,h.jsx)(T,{label:`pathMark pulse`,value:g.status===`ok`?g.checks.slugPulseMatches===null?`n/a`:String(g.checks.slugPulseMatches):`‚Äî`}),(0,h.jsx)(T,{label:`pathMark sig`,value:g.status===`ok`?g.checks.slugShortSigMatches===null?`n/a`:String(g.checks.slugShortSigMatches):`‚Äî`}),(0,h.jsx)(T,{label:`Œ¶-Key seal`,value:g.status===`ok`?g.checks.derivedPhiKeyMatchesEmbedded===null?`n/a`:String(g.checks.derivedPhiKeyMatchesEmbedded):`‚Äî`})]}),(0,h.jsxs)(`div`,{className:`vrail-grid`,"aria-label":`Capsule fields`,children:[(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`‚ò§Kai (pulse)`}),(0,h.jsx)(`code`,{className:`vv mono`,children:Z?String(Z):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember pulse`,ariaLabel:`Remember pulse`,onClick:()=>void Y(String(Z),`Pulse`),disabled:!Z})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`Spiral (chakra)`}),(0,h.jsx)(`code`,{className:`vv mono`,children:Qt??`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Spiral (chakra)`,ariaLabel:`Remember Spiral (chakra)`,onClick:()=>void Y(String(Qt??``),`Spiral (Chakra)`),disabled:!Qt})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`‚ò§kai-Signature`}),(0,h.jsx)(`code`,{className:`vv mono`,title:Zt,children:b(Zt,16,12)}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember ‚ò§Kai-Signature`,ariaLabel:`Remember ‚ò§Kai-Signature`,onClick:()=>void Y(Zt,`‚ò§Kai-Signature`),disabled:!Zt})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`Œ¶-Key`}),(0,h.jsx)(`code`,{className:`vv mono`,title:Q,children:Q===`‚Äî`?`‚Äî`:b(Q,16,12)}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Œ¶-Key`,ariaLabel:`Remember Œ¶-Key`,onClick:()=>void Y(Q,`Œ¶-Key`),disabled:!Q||Q===`‚Äî`})]})]})]})]})})]}):null,u===`proof`?(0,h.jsxs)(`div`,{className:`vcard`,"data-panel":`proof`,children:[(0,h.jsxs)(`div`,{className:`vcard-head`,children:[(0,h.jsx)(`div`,{className:`vcard-title`,children:`Attestation Spine`}),(0,h.jsx)(`div`,{className:`vcard-sub`,children:`vesselHash + sigilHash ‚Üí bundleHash (offline integrity rail).`})]}),(0,h.jsxs)(`div`,{className:`vcard-body vfit`,children:[(0,h.jsxs)(`div`,{className:`vrail-grid vrail-grid--2`,"aria-label":`Proof hash rail`,children:[(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`hash`}),(0,h.jsx)(`code`,{className:`vv mono`,children:pe}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember hash algorithm`,ariaLabel:`Remember hash algorithm`,onClick:()=>void Y(pe,`Hash algorithm`)})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`canon`}),(0,h.jsx)(`code`,{className:`vv mono`,children:`JCS`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember canonicalization`,ariaLabel:`Remember canonicalization`,onClick:()=>void Y(`JCS`,`Canonicalization`)})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`verifier`}),(0,h.jsx)(`code`,{className:`vv mono`,title:q||`‚Äî`,children:q?b(q,22,16):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember verifier URL`,ariaLabel:`Remember verifier URL`,onClick:()=>void Y(q,`Verifier URL`),disabled:!q})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`sigilHash`}),(0,h.jsx)(`code`,{className:`vv mono`,title:O||`‚Äî`,children:O?b(O,22,16):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Œ¶Key hash`,ariaLabel:`Remember SVG hash`,onClick:()=>void Y(O,`SVG hash`),disabled:!O})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`vesselHash`}),(0,h.jsx)(`code`,{className:`vv mono`,title:D||`‚Äî`,children:D?b(D,22,16):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember vessel hash`,ariaLabel:`Remember vessel hash`,onClick:()=>void Y(D,`Vessel hash`),disabled:!D})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`bundleHash`}),(0,h.jsx)(`code`,{className:`vv mono`,title:k||`‚Äî`,children:k?b(k,22,16):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember bundle hash`,ariaLabel:`Remember bundle hash`,onClick:()=>void Y(k,`Bundle hash`),disabled:!k})]})]}),g.status===`ok`&&B!=null?(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--2 vvaluation-dashboard`,"aria-label":`Live valuation`,children:[(0,h.jsx)(T,{label:V===`balance`?`Glyph Œ¶ balance`:V===`embedded`?`Glyph Œ¶ value`:`Live Œ¶ value`,value:t(B)}),(0,h.jsx)(T,{label:V===`balance`?`Glyph USD balance`:V===`embedded`?`Glyph USD value`:`Live USD value`,value:yt==null?`‚Äî`:r(yt)})]}):null,(0,h.jsxs)(`div`,{className:`vfoot`,"aria-label":`Proof actions`,children:[(0,h.jsx)(`div`,{className:`vfoot-left`,children:(0,h.jsx)(`div`,{className:`vchip`,title:`Canonical audit payload`,children:`Audit JSON`})}),(0,h.jsxs)(`div`,{className:`vfoot-right`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (Audit JSON)`,ariaLabel:`Focus View (Audit JSON)`,onClick:()=>H(!0),disabled:!X}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Audit JSON`,ariaLabel:`Remember Audit JSON`,onClick:()=>void Y(X,`Audit JSON`),disabled:!X})]})]})]})]}):null,u===`zk`?(0,h.jsxs)(`div`,{className:`vcard`,"data-panel":`zk`,children:[(0,h.jsxs)(`div`,{className:`vcard-head`,children:[(0,h.jsx)(`div`,{className:`vcard-title`,children:`Zero Knowledge Proof`}),(0,h.jsx)(`div`,{className:`vcard-sub`,children:`Groth16 + Poseidon status; full payloads in Expanded Views.`})]}),(0,h.jsx)(`div`,{className:`vcard-body vfit`,children:(0,h.jsxs)(`div`,{className:`vrail-grid vrail-grid--2`,"aria-label":`ZK rail values`,children:[(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`poseidon`}),(0,h.jsx)(`code`,{className:`vv mono`,title:String(U?.zkPoseidonHash??`‚Äî`),children:U?.zkPoseidonHash?b(String(U.zkPoseidonHash),22,16):`‚Äî`}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Poseidon hash`,ariaLabel:`Remember Poseidon hash`,onClick:()=>void Y(String(U?.zkPoseidonHash??``),`Poseidon hash`),disabled:!U?.zkPoseidonHash})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`groth16`}),(0,h.jsx)(`div`,{className:`vseal-inline`,children:(0,h.jsx)(w,{label:`G16`,state:Vt,detail:`Groth16 verification status`})}),(0,h.jsx)(`span`,{})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`zkProof`}),(0,h.jsx)(`code`,{className:`vv mono`,title:W||`‚Äî`,children:W?b(W.replace(/\s+/g,` `),22,18):`‚Äî`}),(0,h.jsxs)(`div`,{className:`vrow-actions`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (ZK proof)`,ariaLabel:`Focus View (ZK proof)`,onClick:()=>Et(!0),disabled:!W}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember ZK proof`,ariaLabel:`Remember ZK proof`,onClick:()=>void Y(W,`ZK proof`),disabled:!W})]})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`publicInputs`}),(0,h.jsx)(`code`,{className:`vv mono`,title:G||`‚Äî`,children:G?b(G.replace(/\s+/g,` `),22,18):`‚Äî`}),(0,h.jsxs)(`div`,{className:`vrow-actions`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (public inputs)`,ariaLabel:`Focus View (public inputs)`,onClick:()=>Ot(!0),disabled:!G}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember public inputs`,ariaLabel:`Remember public inputs`,onClick:()=>void Y(G,`Public inputs`),disabled:!G})]})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`hints`}),(0,h.jsx)(`code`,{className:`vv mono`,title:K||`‚Äî`,children:K?b(K.replace(/\s+/g,` `),22,18):`‚Äî`}),(0,h.jsxs)(`div`,{className:`vrow-actions`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (hints)`,ariaLabel:`Focus View (hints)`,onClick:()=>At(!0),disabled:!K}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember hints`,ariaLabel:`Remember hints`,onClick:()=>void Y(K,`Proof hints`),disabled:!K})]})]}),(0,h.jsxs)(`div`,{className:`vrow`,children:[(0,h.jsx)(`span`,{className:`vk`,children:`audit`}),(0,h.jsx)(`code`,{className:`vv mono`,children:`bundle JSON`}),(0,h.jsxs)(`div`,{className:`vrow-actions`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (Audit JSON)`,ariaLabel:`Focus View (Audit JSON)`,onClick:()=>H(!0),disabled:!X}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Audit JSON`,ariaLabel:`Remember Audit JSON`,onClick:()=>void Y(X,`Audit JSON`),disabled:!X})]})]})]})})]}):null,u===`audit`?(0,h.jsxs)(`div`,{className:`vcard`,"data-panel":`audit`,children:[(0,h.jsxs)(`div`,{className:`vcard-head`,children:[(0,h.jsx)(`div`,{className:`vcard-title`,children:`Audit`}),(0,h.jsx)(`div`,{className:`vcard-sub`,children:`Attestation bundle parity + author seal validity.`})]}),(0,h.jsxs)(`div`,{className:`vcard-body vfit`,children:[(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--6`,"aria-label":`Audit checks`,children:[(0,h.jsx)(T,{label:`Attestation bundle`,value:A?`present`:`‚Äî`}),(0,h.jsx)(T,{label:`Author signature`,value:A?.authorSig?`present`:`‚Äî`}),(0,h.jsx)(T,{label:`Author verified`,value:M===null?`n/a`:M?`true`:`false`}),(0,h.jsx)(T,{label:`Receive signature`,value:R?`present`:`‚Äî`}),(0,h.jsx)(T,{label:`Receive verified`,value:Qe===null?`n/a`:Qe?`true`:`false`}),(0,h.jsx)(T,{label:`sigilHash parity`,value:A?.svgHash?String(A.svgHash===O):`n/a`}),(0,h.jsx)(T,{label:`vesselHash parity`,value:A?.capsuleHash?String(A.capsuleHash===D):`n/a`}),(0,h.jsx)(T,{label:`bundleHash parity`,value:A?.bundleHash?String(A.bundleHash===k):`n/a`})]}),(0,h.jsx)(`div`,{className:`vmini-grid vmini-grid--3`,"aria-label":`Receive signature status`,children:(0,h.jsx)(T,{label:`Receive credId`,value:qt?b(qt,12,10):`‚Äî`,title:qt||`‚Äî`})}),R?(0,h.jsxs)(`div`,{className:`vmini-grid vmini-grid--2`,"aria-label":`Receive signature summary`,children:[(0,h.jsx)(T,{label:`Receive nonce`,value:Jt?b(Jt,14,12):`‚Äî`,title:Jt||`‚Äî`}),(0,h.jsx)(T,{label:`Receive bundle`,value:Yt?b(Yt,14,12):`‚Äî`,title:Yt||`‚Äî`})]}):null,(0,h.jsxs)(`div`,{className:`vfoot`,"aria-label":`Audit actions`,children:[(0,h.jsx)(`div`,{className:`vfoot-left`,children:(0,h.jsxs)(`div`,{className:`vseals`,"aria-label":`Seal summary`,children:[(0,h.jsx)(w,{label:`KAS`,state:Bt}),(0,h.jsx)(w,{label:`G16`,state:Vt})]})}),(0,h.jsxs)(`div`,{className:`vfoot-right`,children:[(0,h.jsx)(S,{icon:`‚§¢`,title:`Focus View (Audit JSON)`,ariaLabel:`Focus View (Audit JSON)`,onClick:()=>H(!0),disabled:!X}),(0,h.jsx)(S,{icon:`üí†`,title:`Remember Audit JSON`,ariaLabel:`Remember Audit JSON`,onClick:()=>void Y(X,`Audit JSON`),disabled:!X})]})]})]})]}):null]}),(0,h.jsxs)(`nav`,{className:`vtabs`,role:`tablist`,"aria-label":`Verifier views`,children:[(0,h.jsx)(C,{active:u===`inhale`,title:`Inhale`,text:`Inhale`,onClick:()=>d(`inhale`),icon:(0,h.jsx)(`img`,{className:`vtab-phi`,src:`/phi.svg`,alt:``,"aria-hidden":`true`})}),(0,h.jsx)(C,{active:u===`capsule`,title:`Vessel`,text:`Vessel`,onClick:()=>d(`capsule`),icon:`‚óà`}),(0,h.jsx)(C,{active:u===`proof`,title:`Proof`,text:`Proof`,onClick:()=>d(`proof`),icon:(0,h.jsx)(Be,{})}),(0,h.jsx)(C,{active:u===`zk`,title:`ZK`,text:`ZK`,onClick:()=>d(`zk`),icon:(0,h.jsx)(ze,{})}),(0,h.jsx)(C,{active:u===`audit`,title:`Audit`,text:`Audit`,onClick:()=>d(`audit`),icon:`‚ñ¶`}),(0,h.jsx)(`div`,{className:`vtabs-spacer`,"aria-hidden":`true`}),(0,h.jsxs)(`button`,{type:`button`,className:`vverify`,onClick:()=>void Ft(),disabled:v,"aria-label":`Verify now`,title:v?`Verifying‚Ä¶`:`Verify (${sn})`,children:[(0,h.jsx)(`span`,{className:`vverify-ic`,"aria-hidden":`true`,children:`‚ü°`}),(0,h.jsx)(`span`,{className:`vverify-txt`,children:v?`VERIFYING`:`VERIFY`})]})]})]}),(0,h.jsxs)(Ue,{open:St,title:`Œ¶Key Focus View`,subtitle:`Paste/edit sealed SVG (must include <metadata id="kai-voh-proof">{...}</metadata>).`,onClose:()=>Ct(!1),children:[(0,h.jsx)(`textarea`,{className:`vta`,value:f,onChange:e=>{p(e.currentTarget.value),_({status:`idle`})},spellCheck:!1}),(0,h.jsxs)(`div`,{className:`vmodal-actions`,children:[(0,h.jsxs)(`button`,{type:`button`,className:`vcta`,onClick:()=>void Ft(),disabled:v,title:v?`Verifying‚Ä¶`:`Verify`,children:[`‚ü° `,v?`VERIFYING`:`VERIFY`]}),(0,h.jsx)(`button`,{type:`button`,className:`vcta vcta--ghost`,onClick:()=>void Y(f,`SVG`),disabled:!f.trim(),title:`üí† Remember`,children:`üí† REMEMBER`})]})]}),(0,h.jsxs)(Ue,{open:wt,title:`Audit JSON`,subtitle:`Canonical audit payload (vesselHash + sigilHash ‚Üí bundleHash).`,onClose:()=>H(!1),children:[(0,h.jsx)(`textarea`,{className:`vta vta--readonly`,readOnly:!0,value:X||`‚Äî`}),(0,h.jsxs)(`div`,{className:`vmodal-actions`,children:[(0,h.jsx)(`button`,{type:`button`,className:`vcta`,onClick:()=>void Y(X,`Audit JSON`),disabled:!X,title:`üí† Remember`,children:`üí† REMEMBER`}),(0,h.jsx)(`button`,{type:`button`,className:`vcta vcta--ghost`,onClick:()=>H(!1),title:`Close`,children:`CLOSE`})]})]}),(0,h.jsxs)(Ue,{open:Tt,title:`ZK Proof`,subtitle:`Full embedded Groth16 proof payload.`,onClose:()=>Et(!1),children:[(0,h.jsx)(`textarea`,{className:`vta vta--readonly`,readOnly:!0,value:W||`‚Äî`}),(0,h.jsxs)(`div`,{className:`vmodal-actions`,children:[(0,h.jsx)(`button`,{type:`button`,className:`vcta`,onClick:()=>void Y(W,`ZK proof`),disabled:!W,title:`üí† Remember`,children:`üí† REMEMBER`}),(0,h.jsx)(`button`,{type:`button`,className:`vcta vcta--ghost`,onClick:()=>Et(!1),title:`Close`,children:`CLOSE`})]})]}),(0,h.jsxs)(Ue,{open:Dt,title:`ZK Public Inputs`,subtitle:`Full embedded public inputs payload.`,onClose:()=>Ot(!1),children:[(0,h.jsx)(`textarea`,{className:`vta vta--readonly`,readOnly:!0,value:G||`‚Äî`}),(0,h.jsxs)(`div`,{className:`vmodal-actions`,children:[(0,h.jsx)(`button`,{type:`button`,className:`vcta`,onClick:()=>void Y(G,`Public inputs`),disabled:!G,title:`üí† Remember`,children:`üí† REMEMBER`}),(0,h.jsx)(`button`,{type:`button`,className:`vcta vcta--ghost`,onClick:()=>Ot(!1),title:`Close`,children:`CLOSE`})]})]}),(0,h.jsxs)(Ue,{open:kt,title:`Proof Hints`,subtitle:`Explorer/API hints embedded in the bundle.`,onClose:()=>At(!1),children:[(0,h.jsx)(`textarea`,{className:`vta vta--readonly`,readOnly:!0,value:K||`‚Äî`}),(0,h.jsxs)(`div`,{className:`vmodal-actions`,children:[(0,h.jsx)(`button`,{type:`button`,className:`vcta`,onClick:()=>void Y(K,`Proof hints`),disabled:!K,title:`üí† Remember`,children:`üí† REMEMBER`}),(0,h.jsx)(`button`,{type:`button`,className:`vcta vcta--ghost`,onClick:()=>At(!1),title:`Close`,children:`CLOSE`})]})]})]})}export{E as default};