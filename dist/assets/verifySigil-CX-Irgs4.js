import{j as e,jt as t}from"./index-DOHz2zUr.js";function n(e){let t=decodeURIComponent(e||``).trim(),n=t.match(/^(\d+)-([A-Za-z0-9]+)$/);if(!n)return{raw:t,pulse:null,shortSig:null};let r=Number(n[1]);return{raw:t,pulse:Number.isFinite(r)&&r>0?r:null,shortSig:n[2]?String(n[2]):null}}function r(e,t){return e.length<=t?e:e.slice(0,t)}async function i(n,i){try{let a=e(i),o=(a.kaiSignature??``).trim();if(!o)return{status:`error`,message:`No kaiSignature found in the SVG metadata.`,slug:n,embedded:a};let s=await t(o),c=(a.phiKey??``).trim(),l=a.pulseExact,u=l&&Number.isFinite(Number(l))?Number(l):a.pulse,d={hasSignature:!0,slugPulseMatches:n.pulse==null||u==null?null:n.pulse===u,slugShortSigMatches:n.shortSig==null?null:n.shortSig===r(o,n.shortSig.length),derivedPhiKeyMatchesEmbedded:c.length===0?null:s===c};return d.slugPulseMatches===!1||d.slugShortSigMatches===!1||d.derivedPhiKeyMatchesEmbedded===!1?{status:`error`,message:`Verification failed: one or more checks did not match.`,slug:n,embedded:a,derivedPhiKey:s,checks:d}:{status:`ok`,slug:n,embedded:{...a,pulse:u??a.pulse,phiKey:c.length>0?c:s},derivedPhiKey:s,checks:d}}catch(e){return{status:`error`,message:e instanceof Error?e.message:`Verification failed.`,slug:n}}}export{i as n,n as t};