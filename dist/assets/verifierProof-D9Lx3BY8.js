function e(e){return e===null||typeof e==`string`||typeof e==`number`||typeof e==`boolean`}function t(e){return Number.isFinite(e)?JSON.stringify(e):`null`}function n(r){if(e(r))return typeof r==`number`?t(r):JSON.stringify(r);if(typeof r==`bigint`)throw TypeError(`JCS does not support bigint values.`);if(typeof r==`function`||typeof r==`symbol`||r===void 0)return`null`;if(r&&typeof r==`object`){if(typeof r.toJSON==`function`)return n(r.toJSON());if(Array.isArray(r))return`[${r.map(e=>e===void 0||typeof e==`function`||typeof e==`symbol`?`null`:n(e)).join(`,`)}]`;let e=r,t=Object.keys(e).sort(),i=[];for(let r of t){let t=e[r];t===void 0||typeof t==`function`||typeof t==`symbol`||i.push(`${JSON.stringify(r)}:${n(t)}`)}return`{${i.join(`,`)}}`}return`null`}function r(e){return n(e)}var i=new TextEncoder;function a(e){return typeof e==`string`?i.encode(e):e}async function o(e){let t=a(e),n=await crypto.subtle.digest(`SHA-256`,t.slice().buffer);return new Uint8Array(n)}async function s(e){let t=await o(e);return Array.from(t).map(e=>e.toString(16).padStart(2,`0`)).join(``)}function c(e){let t=``;for(let n of e)t+=String.fromCharCode(n);return btoa(t).replace(/\+/g,`-`).replace(/\//g,`_`).replace(/=+$/g,``)}function l(e){let t=e.replace(/-/g,`+`).replace(/_/g,`/`),n=t.length%4==0?``:`=`.repeat(4-t.length%4),r=atob(`${t}${n}`),i=new Uint8Array(r.length);for(let e=0;e<r.length;e+=1)i[e]=r.charCodeAt(e);return i}var u=`kai-voh-proof`,d=RegExp(`<metadata\\b[^>]*id=["']${u}["'][^>]*>[\\s\\S]*?<\\/metadata>`,`gi`);function f(e){return e.replace(d,``)}function p(e){return f(e)}function m(e,t){let n=`<metadata id="${u}" type="application/json"><![CDATA[${JSON.stringify(t)}]]></metadata>`;if(d.lastIndex=0,d.test(e))return d.lastIndex=0,e.replace(d,n);let r=e.lastIndexOf(`</svg>`);return r===-1?`${e}${n}`:`${e.slice(0,r)}${n}${e.slice(r)}`}const h=`sha256`,g=`JCS`,_=`kai-voh-proof`;function v(e){return e.replace(/^\/+|\/+$/g,``)}function y(){try{return`/`}catch{}return`/`}function b(){if(typeof window>`u`)return`/verify`;let e=window.location.origin,t=v(y());return`${e}${t.length>0?`/${t}`:``}/verify`}function x(e){let t=typeof e==`string`?e.trim():``,n=t.length>0?t:`unknown-signature`;return n.length>10?n.slice(0,10):n}function S(e,t){return`${e}-${x(t)}`}function C(e,t,n){return`${(n??b()).replace(/\/+$/,``)}/${encodeURIComponent(S(e,t))}`}var w={root:`Root`,sacral:`Sacral`,solar:`Solar Plexus`,solarp:`Solar Plexus`,solarplexus:`Solar Plexus`,heart:`Heart`,throat:`Throat`,thirdeye:`Third Eye`,crown:`Crown`,krown:`Crown`};function T(e){if(typeof e!=`string`)return;let t=e.trim();if(t)return w[t.toLowerCase().replace(/[\s_-]/g,``)]}function E(e){return r({v:e.v,pulse:e.pulse,chakraDay:e.chakraDay,kaiSignature:e.kaiSignature,phiKey:e.phiKey,verifierSlug:e.verifierSlug})}async function D(e){return await s(E(e))}async function O(e){return await s(p(e))}async function k(e,t){return await s(r({capsuleHash:e,svgHash:t}))}export{s as _,C as a,D as c,x as d,m as f,o as g,c as h,S as i,O as l,l as m,h as n,b as o,p,_ as r,k as s,g as t,T as u,r as v};