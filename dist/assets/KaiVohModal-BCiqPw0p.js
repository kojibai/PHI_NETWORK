const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KaiVohApp-DVdpMovz.js","assets/index-ChwrPS3I.js","assets/index-BgUnq8XG.css","assets/browser-tgLemYHd.js","assets/SigilAuthContext-BZjnZIE6.js","assets/ticker-DdgOkVWs.js","assets/ticker-B0glx6FE.css","assets/VerifierFrame-CYaFRo-v.js","assets/VerifierFrame-CSoanQJ_.css","assets/sessionStorage-CKL6_xzc.js","assets/postSeal-DE4BCNSp.js","assets/webauthnKAS-CuMdvRcy.js","assets/KaiVohApp-Brroi08x.css","assets/KaiRealms-qO59o4ZN.js","assets/x-1BE5xoKC.js","assets/KaiRealms-BZJvSAmB.css"])))=>i.map(i=>d[i]);
import{t as e}from"./x-1BE5xoKC.js";import{bi as t,fi as n,mi as r,qt as i,ui as a}from"./index-ChwrPS3I.js";import{t as o}from"./SigilAuthContext-BZjnZIE6.js";import{n as s}from"./sessionStorage-CKL6_xzc.js";import{t as c}from"./SigilAuthProvider-CXkjKapy.js";var l=t(n(),1),u=t(r(),1),d=t(i(),1),f=class extends u.Component{state={error:null};static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error(`[KaiVoh] render error:`,e,t)}render(){return this.state.error?(0,d.jsxs)(`div`,{style:{padding:`1rem`,textAlign:`center`},children:[(0,d.jsx)(`h2`,{style:{fontSize:18,fontWeight:600},children:`KaiVoh failed to load`}),(0,d.jsx)(`p`,{style:{opacity:.8,marginTop:8},children:this.state.error.message}),(0,d.jsxs)(`details`,{style:{opacity:.65,marginTop:12,textAlign:`left`},children:[(0,d.jsx)(`summary`,{children:`Details`}),(0,d.jsx)(`pre`,{style:{whiteSpace:`pre-wrap`},children:String(this.state.error.stack??``)})]})]}):this.props.children}};function p(){let e=(0,u.useContext)(o);if(!e)throw Error(`useSigilAuth must be used inside <SigilAuthProvider>`);return e}var m=(0,u.lazy)(()=>a(()=>import(`./KaiVohApp-DVdpMovz.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),h=(0,u.lazy)(()=>a(()=>import(`./KaiRealms-qO59o4ZN.js`),__vite__mapDeps([13,1,2,14,15]))),g=(1+Math.sqrt(5))/2,_=5.236,v=610,y=377;function b({className:e}){let t=(0,u.useId)();return(0,d.jsxs)(`svg`,{className:e,width:v,height:y,viewBox:`0 0 ${v} ${y}`,"aria-hidden":`true`,focusable:`false`,children:[(0,d.jsx)(`defs`,{children:(0,d.jsxs)(`linearGradient`,{id:t,x1:`0`,y1:`0`,x2:`1`,y2:`1`,children:[(0,d.jsx)(`stop`,{offset:`0%`,stopColor:`currentColor`,stopOpacity:`0.0`}),(0,d.jsx)(`stop`,{offset:`40%`,stopColor:`currentColor`,stopOpacity:`0.5`}),(0,d.jsx)(`stop`,{offset:`100%`,stopColor:`currentColor`,stopOpacity:`0.0`})]})}),(0,d.jsxs)(`g`,{fill:`none`,stroke:`url(#${t})`,strokeWidth:`2`,children:[(0,d.jsx)(`path`,{d:`M377 0 A377 377 0 0 1 0 377`}),(0,d.jsx)(`path`,{d:`M233 0 A233 233 0 0 1 0 233`}),(0,d.jsx)(`path`,{d:`M144 0 A144 144 0 0 1 0 144`}),(0,d.jsx)(`path`,{d:`M89 0 A89 89 0 0 1 0 89`}),(0,d.jsx)(`path`,{d:`M55 0 A55 55 0 0 1 0 55`}),(0,d.jsx)(`path`,{d:`M34 0 A34 34 0 0 1 0 34`}),(0,d.jsx)(`path`,{d:`M21 0 A21 21 0 0 1 0 21`})]})]})}function x({className:e}){return(0,d.jsxs)(`div`,{className:`seal-emblem ${e??``}`,"aria-hidden":`true`,children:[(0,d.jsx)(`div`,{className:`seal-ring seal-ring--outer`}),(0,d.jsx)(`div`,{className:`seal-ring seal-ring--inner`}),(0,d.jsx)(`div`,{className:`seal-core`})]})}function S({className:e}){let{auth:t}=p(),n=t.meta;if(!n)return null;let r=[`Pulse: ${n.pulse}`,`Beat: ${n.beat}`,`Step: ${n.stepIndex}`,`Day: ${n.chakraDay}`];return n.sigilId&&r.push(`Sigil: ${n.sigilId}`),n.userPhiKey&&r.push(`PhiKey: ${n.userPhiKey}`),(0,d.jsxs)(`div`,{className:`sigil-auth-pill ${e??``}`,role:`status`,"aria-live":`polite`,title:r.join(` â€¢ `),style:{maxWidth:`100%`,overflowX:`auto`,whiteSpace:`nowrap`},children:[(0,d.jsx)(`span`,{className:`sigil-auth-pill__dot`,"aria-hidden":`true`}),(0,d.jsxs)(`span`,{className:`sigil-auth-pill__text mono`,children:[`Sealed â€¢ `,n.pulse,` â€¢ `,n.chakraDay,n.sigilId?` â€¢ ${n.sigilId}`:``]})]})}function C(e){return e?Array.from(e.querySelectorAll([`a[href]`,`button:not([disabled])`,`input:not([disabled])`,`select:not([disabled])`,`textarea:not([disabled])`,`[tabindex]:not([tabindex='-1'])`].join(`,`))).filter(e=>!e.hasAttribute(`disabled`)&&!e.getAttribute(`aria-hidden`)):[]}function w(e){return e?e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement?!e.disabled:!!(e instanceof HTMLElement&&e.isContentEditable):!1}function T(e){if(!e||e instanceof HTMLTextAreaElement)return!1;if(e instanceof HTMLSelectElement)return!0;if(e instanceof HTMLInputElement){let t=e.type.toLowerCase();return![`button`,`submit`,`reset`,`checkbox`,`radio`,`file`,`range`,`color`].includes(t)}return!1}function E({open:t,onClose:n}){let r=(0,u.useCallback)(()=>{s(),n()},[n]),i=(0,u.useRef)(null),a=(0,u.useRef)(null),o=(0,u.useRef)(null),p=(0,u.useRef)(0),v=(0,u.useRef)(0),[y,E]=(0,u.useState)(`voh`),[D,O]=(0,u.useState)(!1),k=(0,u.useCallback)(e=>{e===`realms`&&!D&&O(!0),E(e)},[D]),A=(0,u.useMemo)(()=>({breath:`${_}s`,phi:`${g}`}),[]);(0,u.useEffect)(()=>{if(!t)return;let e=!window.matchMedia?.(`(pointer: coarse)`)?.matches,n={bodyOverflow:document.body.style.overflow,bodyPosition:document.body.style.position,bodyTop:document.body.style.top,bodyLeft:document.body.style.left,bodyRight:document.body.style.right,bodyWidth:document.body.style.width,bodyHeight:document.body.style.height,htmlOverflow:document.documentElement.style.overflow,htmlHeight:document.documentElement.style.height,docOverscroll:document.documentElement.style.getPropertyValue(`overscroll-behavior`),bodyOverscroll:document.body.style.getPropertyValue(`overscroll-behavior`),touchAction:document.documentElement.style.touchAction,breath:document.documentElement.style.getPropertyValue(`--kai-breath`),phi:document.documentElement.style.getPropertyValue(`--kai-phi`),kaiVh:document.documentElement.style.getPropertyValue(`--kai-vh`)};v.current=window.scrollY||window.pageYOffset||0,document.body.style.position=`fixed`,document.body.style.top=`-${v.current}px`,document.body.style.left=`0`,document.body.style.right=`0`,document.body.style.width=`100%`,document.body.style.height=`100%`,document.body.style.overflow=`hidden`,document.documentElement.style.overflow=`hidden`,document.documentElement.style.height=`100%`,document.documentElement.style.setProperty(`overscroll-behavior`,`none`),document.body.style.setProperty(`overscroll-behavior`,`none`),document.documentElement.style.touchAction=`manipulation`,document.documentElement.style.setProperty(`--kai-breath`,A.breath),document.documentElement.style.setProperty(`--kai-phi`,A.phi);let s=()=>{document.documentElement.style.setProperty(`--kai-vh`,`${window.innerHeight}px`)};s(),window.addEventListener(`resize`,s,{passive:!0});let c=o.current;c&&(c.style.overscrollBehavior=`contain`,c.style.webkitOverflowScrolling=`touch`),a.current?.focus();let l=e=>{p.current=e.touches[0]?.clientY??0},u=e=>{if(e.touches.length!==1)return;let t=o.current;if(!t){e.preventDefault();return}let n=e.target;if(!(n&&t.contains(n))){e.preventDefault();return}let r=(e.touches[0]?.clientY??p.current)-p.current,i=t.scrollTop<=0,a=t.scrollTop+t.clientHeight>=t.scrollHeight-1;(i&&r>0||a&&r<0)&&e.preventDefault()},d=e=>{let t=o.current;if(!t){e.preventDefault();return}let n=e.target;if(!(n&&t.contains(n))){e.preventDefault();return}let r=e.deltaY,i=t.scrollTop<=0,a=t.scrollTop+t.clientHeight>=t.scrollHeight-1;(i&&r<0||a&&r>0)&&e.preventDefault()},f=t=>{if(t.key===`Escape`){if(!e||w(document.activeElement)||w(t.target))return;t.preventDefault(),t.stopPropagation(),r();return}if(t.key===`Enter`){let e=t.target;T(e)&&i.current?.contains(e)&&t.preventDefault()}if(t.key!==`Tab`)return;let n=i.current,a=C(n);if(a.length===0)return;let o=document.activeElement,s=a[0],c=a[a.length-1];if(!o||!n?.contains(o)){t.preventDefault(),s.focus();return}t.shiftKey?o===s&&(t.preventDefault(),c.focus()):o===c&&(t.preventDefault(),s.focus())},m=new AbortController,h={passive:!0,signal:m.signal,capture:!0},g={passive:!1,signal:m.signal,capture:!0},_={passive:!1,signal:m.signal,capture:!0},y={signal:m.signal,capture:!0};document.addEventListener(`touchstart`,l,h),document.addEventListener(`touchmove`,u,g),document.addEventListener(`wheel`,d,_),document.addEventListener(`keydown`,f,y);let b=e=>{e.preventDefault()};return document.addEventListener(`gesturestart`,b,{passive:!1,signal:m.signal}),document.addEventListener(`gesturechange`,b,{passive:!1,signal:m.signal}),document.addEventListener(`gestureend`,b,{passive:!1,signal:m.signal}),document.addEventListener(`submit`,e=>{let t=e.target;t&&i.current?.contains(t)&&(e.preventDefault(),e.stopPropagation())},{capture:!0,signal:m.signal}),()=>{m.abort(),window.removeEventListener(`resize`,s),document.body.style.overflow=n.bodyOverflow,document.body.style.position=n.bodyPosition,document.body.style.top=n.bodyTop,document.body.style.left=n.bodyLeft,document.body.style.right=n.bodyRight,document.body.style.width=n.bodyWidth,document.body.style.height=n.bodyHeight,document.documentElement.style.overflow=n.htmlOverflow,document.documentElement.style.height=n.htmlHeight,n.docOverscroll?document.documentElement.style.setProperty(`overscroll-behavior`,n.docOverscroll):document.documentElement.style.removeProperty(`overscroll-behavior`),n.bodyOverscroll?document.body.style.setProperty(`overscroll-behavior`,n.bodyOverscroll):document.body.style.removeProperty(`overscroll-behavior`),document.documentElement.style.touchAction=n.touchAction,n.breath?document.documentElement.style.setProperty(`--kai-breath`,n.breath):document.documentElement.style.removeProperty(`--kai-breath`),n.phi?document.documentElement.style.setProperty(`--kai-phi`,n.phi):document.documentElement.style.removeProperty(`--kai-phi`),n.kaiVh?document.documentElement.style.setProperty(`--kai-vh`,n.kaiVh):document.documentElement.style.removeProperty(`--kai-vh`);let e=v.current||0;window.scrollTo(0,e)}},[t,r,A.breath,A.phi]);let j=(0,u.useCallback)(e=>{e.stopPropagation(),r()},[r]),M=(0,u.useCallback)(e=>{(e.key===`Enter`||e.key===` `)&&(e.preventDefault(),e.stopPropagation(),r())},[r]);return t?(0,l.createPortal)((0,d.jsxs)(`div`,{ref:i,className:`kai-voh-modal-backdrop atlantean-veil`,role:`dialog`,"aria-modal":`true`,"aria-labelledby":`kaivoh-title`,"data-view":y,children:[(0,d.jsx)(`div`,{className:`atlantean-stars`,"aria-hidden":`true`}),(0,d.jsx)(`div`,{className:`atlantean-halo atlantean-halo--1`,"aria-hidden":`true`}),(0,d.jsx)(`div`,{className:`atlantean-halo atlantean-halo--2`,"aria-hidden":`true`}),(0,d.jsxs)(`div`,{className:`kai-voh-container kai-pulse-border glass-omni`,role:`document`,children:[(0,d.jsx)(`div`,{className:`breath-ring breath-ring--outer`,"aria-hidden":`true`}),(0,d.jsx)(`div`,{className:`breath-ring breath-ring--inner`,"aria-hidden":`true`}),(0,d.jsx)(`div`,{className:`phi-grid`,"aria-hidden":`true`}),(0,d.jsx)(b,{className:`phi-spiral phi-spiral--tl`}),(0,d.jsx)(b,{className:`phi-spiral phi-spiral--br`}),(0,d.jsxs)(c,{children:[y!==`realms`&&(0,d.jsx)(`button`,{ref:a,type:`button`,className:`kai-voh-close auric-btn`,"aria-label":`Close portal`,onPointerDown:j,onKeyDown:M,children:(0,d.jsx)(e,{size:22,"aria-hidden":`true`})}),y!==`realms`&&(0,d.jsx)(`div`,{className:`voh-top-orb`,"aria-hidden":`true`,children:(0,d.jsx)(x,{})}),(0,d.jsxs)(`div`,{className:`kai-voh-tabbar`,role:`tablist`,"aria-label":`Kai portal views`,children:[(0,d.jsxs)(`button`,{type:`button`,role:`tab`,"aria-selected":y===`voh`,className:`kai-voh-tab auric-tab ${y===`voh`?`active`:``}`,onClick:()=>k(`voh`),children:[(0,d.jsx)(`span`,{className:`tab-glyph`,"aria-hidden":`true`,children:`ðŸœ‚`}),` `,`Voh`]}),(0,d.jsxs)(`button`,{type:`button`,role:`tab`,"aria-selected":y===`realms`,className:`kai-voh-tab auric-tab ${y===`realms`?`active`:``}`,onClick:()=>k(`realms`),children:[(0,d.jsx)(`span`,{className:`tab-glyph`,"aria-hidden":`true`,children:`âšš`}),` `,`Realms`]}),(0,d.jsx)(`div`,{className:`breath-meter`,"aria-hidden":`true`,children:(0,d.jsx)(`div`,{className:`breath-meter__dot`})}),(0,d.jsx)(S,{className:`sigil-auth-pill--tabbar`})]}),(0,d.jsxs)(`div`,{className:`kai-voh-body`,ref:o,children:[(0,d.jsx)(`h2`,{id:`kaivoh-title`,className:`sr-only`,children:`Kai Portal`}),(0,d.jsxs)(f,{children:[(0,d.jsx)(`section`,{className:`portal-pane portal-pane--voh`,style:{display:y===`voh`?`block`:`none`},"aria-hidden":y!==`voh`,children:(0,d.jsx)(u.Suspense,{fallback:(0,d.jsxs)(`div`,{className:`kai-voh-center`,children:[(0,d.jsx)(`div`,{className:`kai-voh-spinner`}),(0,d.jsx)(`div`,{children:`Summoning Vohâ€¦`})]}),children:(0,d.jsx)(m,{})})}),(0,d.jsx)(`section`,{className:`portal-pane portal-pane--realms`,style:{display:y===`realms`?`block`:`none`},"aria-hidden":y!==`realms`,children:D?(0,d.jsx)(u.Suspense,{fallback:(0,d.jsxs)(`div`,{className:`kai-voh-center`,children:[(0,d.jsx)(`div`,{className:`kai-voh-spinner`}),(0,d.jsx)(`div`,{children:`Opening Kai Realmsâ€¦`})]}),children:(0,d.jsx)(h,{onClose:()=>k(`voh`)})}):null})]})]})]})]})]}),document.body):null}export{E as default};