function e(e){return e===null||typeof e==`string`||typeof e==`number`||typeof e==`boolean`}function t(e){return Number.isFinite(e)?JSON.stringify(e):`null`}function n(r){if(e(r))return typeof r==`number`?t(r):JSON.stringify(r);if(typeof r==`bigint`)throw TypeError(`JCS does not support bigint values.`);if(typeof r==`function`||typeof r==`symbol`||r===void 0)return`null`;if(r&&typeof r==`object`){if(typeof r.toJSON==`function`)return n(r.toJSON());if(Array.isArray(r))return`[${r.map(e=>e===void 0||typeof e==`function`||typeof e==`symbol`?`null`:n(e)).join(`,`)}]`;let e=r,t=Object.keys(e).sort(),i=[];for(let r of t){let t=e[r];t===void 0||typeof t==`function`||typeof t==`symbol`||i.push(`${JSON.stringify(r)}:${n(t)}`)}return`{${i.join(`,`)}}`}return`null`}function r(e){return n(e)}var i=new TextEncoder;function a(e){return typeof e==`string`?i.encode(e):e}async function o(e){let t=a(e),n=await crypto.subtle.digest(`SHA-256`,t.slice().buffer);return new Uint8Array(n)}async function s(e){let t=await o(e);return Array.from(t).map(e=>e.toString(16).padStart(2,`0`)).join(``)}var c=`kai-voh-proof`,l=RegExp(`<metadata\\b[^>]*id=["']${c}["'][^>]*>[\\s\\S]*?<\\/metadata>`,`gi`);function u(e){return e.replace(l,``)}function d(e){return u(e)}function f(e,t){let n=`<metadata id="${c}" type="application/json"><![CDATA[${JSON.stringify(t)}]]></metadata>`;if(l.lastIndex=0,l.test(e))return l.lastIndex=0,e.replace(l,n);let r=e.lastIndexOf(`</svg>`);return r===-1?`${e}${n}`:`${e.slice(0,r)}${n}${e.slice(r)}`}const p=`sha256`,m=`JCS`,h=`kai-voh-proof`;function g(e){return e.replace(/^\/+|\/+$/g,``)}function _(){try{return`/`}catch{}return`/`}function v(){if(typeof window>`u`)return`/verify`;let e=window.location.origin,t=g(_());return`${e}${t.length>0?`/${t}`:``}/verify`}function y(e){let t=typeof e==`string`?e.trim():``,n=t.length>0?t:`unknown-signature`;return n.length>10?n.slice(0,10):n}function b(e,t){return`${e}-${y(t)}`}function x(e,t,n){return`${(n??v()).replace(/\/+$/,``)}/${encodeURIComponent(b(e,t))}`}var S={root:`Root`,sacral:`Sacral`,solar:`Solar Plexus`,solarp:`Solar Plexus`,solarplexus:`Solar Plexus`,heart:`Heart`,throat:`Throat`,thirdeye:`Third Eye`,crown:`Crown`,krown:`Crown`};function C(e){if(typeof e!=`string`)return;let t=e.trim();if(t)return S[t.toLowerCase().replace(/[\s_-]/g,``)]}function w(e){return r({v:e.v,pulse:e.pulse,chakraDay:e.chakraDay,kaiSignature:e.kaiSignature,phiKey:e.phiKey,verifierSlug:e.verifierSlug})}async function T(e){return await s(w(e))}async function E(e){return await s(d(e))}async function D(e,t){return await s(r({capsuleHash:e,svgHash:t}))}export{x as a,T as c,y as d,f,b as i,E as l,r as m,p as n,v as o,s as p,h as r,D as s,m as t,C as u};