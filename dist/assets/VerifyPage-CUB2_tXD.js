import{Dr as e,Nr as t,Z as n,ut as r}from"./index-gI1v8FdO.js";import"./prop-types-l-Xzc4KJ.js";import{t as i}from"./VerifierFrame-BHivF0lk.js";var a=`:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD`;a+``;const o=`[`+a+`][:A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*`;var s=RegExp(`^`+o+`$`);function c(e,t){let n=[],r=t.exec(e);for(;r;){let i=[];i.startIndex=t.lastIndex-r[0].length;let a=r.length;for(let e=0;e<a;e++)i.push(r[e]);n.push(i),r=t.exec(e)}return n}const l=function(e){return s.exec(e)!=null};function u(e){return e!==void 0}var d={allowBooleanAttributes:!1,unpairedTags:[]};function f(e,t){t=Object.assign({},d,t);let n=[],r=!1,i=!1;e[0]===`﻿`&&(e=e.substr(1));for(let a=0;a<e.length;a++)if(e[a]===`<`&&e[a+1]===`?`){if(a+=2,a=m(e,a),a.err)return a}else if(e[a]===`<`){let o=a;if(a++,e[a]===`!`){a=h(e,a);continue}else{let s=!1;e[a]===`/`&&(s=!0,a++);let c=``;for(;a<e.length&&e[a]!==`>`&&e[a]!==` `&&e[a]!==`	`&&e[a]!==`
`&&e[a]!==`\r`;a++)c+=e[a];if(c=c.trim(),c[c.length-1]===`/`&&(c=c.substring(0,c.length-1),a--),!se(c)){let t;return t=c.trim().length===0?`Invalid space after '<'.`:`Tag '`+c+`' is an invalid name.`,_(`InvalidTag`,t,v(e,a))}let l=ne(e,a);if(l===!1)return _(`InvalidAttr`,`Attributes for '`+c+`' have open quote.`,v(e,a));let u=l.value;if(a=l.index,u[u.length-1]===`/`){let n=a-u.length;u=u.substring(0,u.length-1);let i=g(u,t);if(i===!0)r=!0;else return _(i.err.code,i.err.msg,v(e,n+i.err.line))}else if(s)if(l.tagClosed){if(u.trim().length>0)return _(`InvalidTag`,`Closing tag '`+c+`' can't have attributes or invalid starting.`,v(e,o));if(n.length===0)return _(`InvalidTag`,`Closing tag '`+c+`' has not been opened.`,v(e,o));{let t=n.pop();if(c!==t.tagName){let n=v(e,t.tagStartPos);return _(`InvalidTag`,`Expected closing tag '`+t.tagName+`' (opened in line `+n.line+`, col `+n.col+`) instead of closing tag '`+c+`'.`,v(e,o))}n.length==0&&(i=!0)}}else return _(`InvalidTag`,`Closing tag '`+c+`' doesn't have proper closing.`,v(e,a));else{let s=g(u,t);if(s!==!0)return _(s.err.code,s.err.msg,v(e,a-u.length+s.err.line));if(i===!0)return _(`InvalidXml`,`Multiple possible root nodes found.`,v(e,a));t.unpairedTags.indexOf(c)!==-1||n.push({tagName:c,tagStartPos:o}),r=!0}for(a++;a<e.length;a++)if(e[a]===`<`)if(e[a+1]===`!`){a++,a=h(e,a);continue}else if(e[a+1]===`?`){if(a=m(e,++a),a.err)return a}else break;else if(e[a]===`&`){let t=ae(e,a);if(t==-1)return _(`InvalidChar`,`char '&' is not expected.`,v(e,a));a=t}else if(i===!0&&!p(e[a]))return _(`InvalidXml`,`Extra text at the end`,v(e,a));e[a]===`<`&&a--}}else{if(p(e[a]))continue;return _(`InvalidChar`,`char '`+e[a]+`' is not expected.`,v(e,a))}if(r){if(n.length==1)return _(`InvalidTag`,`Unclosed tag '`+n[0].tagName+`'.`,v(e,n[0].tagStartPos));if(n.length>0)return _(`InvalidXml`,`Invalid '`+JSON.stringify(n.map(e=>e.tagName),null,4).replace(/\r?\n/g,``)+`' found.`,{line:1,col:1})}else return _(`InvalidXml`,`Start tag expected.`,1);return!0}function p(e){return e===` `||e===`	`||e===`
`||e===`\r`}function m(e,t){let n=t;for(;t<e.length;t++)if(e[t]==`?`||e[t]==` `){let r=e.substr(n,t-n);if(t>5&&r===`xml`)return _(`InvalidXml`,`XML declaration allowed only at the start of the document.`,v(e,t));if(e[t]==`?`&&e[t+1]==`>`){t++;break}else continue}return t}function h(e,t){if(e.length>t+5&&e[t+1]===`-`&&e[t+2]===`-`){for(t+=3;t<e.length;t++)if(e[t]===`-`&&e[t+1]===`-`&&e[t+2]===`>`){t+=2;break}}else if(e.length>t+8&&e[t+1]===`D`&&e[t+2]===`O`&&e[t+3]===`C`&&e[t+4]===`T`&&e[t+5]===`Y`&&e[t+6]===`P`&&e[t+7]===`E`){let n=1;for(t+=8;t<e.length;t++)if(e[t]===`<`)n++;else if(e[t]===`>`&&(n--,n===0))break}else if(e.length>t+9&&e[t+1]===`[`&&e[t+2]===`C`&&e[t+3]===`D`&&e[t+4]===`A`&&e[t+5]===`T`&&e[t+6]===`A`&&e[t+7]===`[`){for(t+=8;t<e.length;t++)if(e[t]===`]`&&e[t+1]===`]`&&e[t+2]===`>`){t+=2;break}}return t}var ee=`"`,te=`'`;function ne(e,t){let n=``,r=``,i=!1;for(;t<e.length;t++){if(e[t]===ee||e[t]===te)r===``?r=e[t]:r!==e[t]||(r=``);else if(e[t]===`>`&&r===``){i=!0;break}n+=e[t]}return r===``?{value:n,index:t,tagClosed:i}:!1}var re=RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,`g`);function g(e,t){let n=c(e,re),r={};for(let e=0;e<n.length;e++){if(n[e][1].length===0)return _(`InvalidAttr`,`Attribute '`+n[e][2]+`' has no space in starting.`,y(n[e]));if(n[e][3]!==void 0&&n[e][4]===void 0)return _(`InvalidAttr`,`Attribute '`+n[e][2]+`' is without value.`,y(n[e]));if(n[e][3]===void 0&&!t.allowBooleanAttributes)return _(`InvalidAttr`,`boolean attribute '`+n[e][2]+`' is not allowed.`,y(n[e]));let i=n[e][2];if(!oe(i))return _(`InvalidAttr`,`Attribute '`+i+`' is an invalid name.`,y(n[e]));if(!r.hasOwnProperty(i))r[i]=1;else return _(`InvalidAttr`,`Attribute '`+i+`' is repeated.`,y(n[e]))}return!0}function ie(e,t){let n=/\d/;for(e[t]===`x`&&(t++,n=/[\da-fA-F]/);t<e.length;t++){if(e[t]===`;`)return t;if(!e[t].match(n))break}return-1}function ae(e,t){if(t++,e[t]===`;`)return-1;if(e[t]===`#`)return t++,ie(e,t);let n=0;for(;t<e.length;t++,n++)if(!(e[t].match(/\w/)&&n<20)){if(e[t]===`;`)break;return-1}return t}function _(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function oe(e){return l(e)}function se(e){return l(e)}function v(e,t){let n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function y(e){return e.startIndex+e[1].length}const ce={preserveOrder:!1,attributeNamePrefix:`@_`,attributesGroupName:!1,textNodeName:`#text`,ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,n){return e},captureMetaData:!1},le=function(e){return Object.assign({},ce,e)};var b=typeof Symbol==`function`?Symbol(`XML Node Metadata`):`@@xmlMetadata`,x=class{constructor(e){this.tagname=e,this.child=[],this[`:@`]={}}add(e,t){e===`__proto__`&&(e=`#__proto__`),this.child.push({[e]:t})}addChild(e,t){e.tagname===`__proto__`&&(e.tagname=`#__proto__`),e[`:@`]&&Object.keys(e[`:@`]).length>0?this.child.push({[e.tagname]:e.child,":@":e[`:@`]}):this.child.push({[e.tagname]:e.child}),t!==void 0&&(this.child[this.child.length-1][b]={startIndex:t})}static getMetaDataSymbol(){return b}},ue=class{constructor(e){this.suppressValidationErr=!e}readDocType(e,t){let n={};if(e[t+3]===`O`&&e[t+4]===`C`&&e[t+5]===`T`&&e[t+6]===`Y`&&e[t+7]===`P`&&e[t+8]===`E`){t+=9;let r=1,i=!1,a=!1,o=``;for(;t<e.length;t++)if(e[t]===`<`&&!a){if(i&&C(e,`!ENTITY`,t)){t+=7;let r,i;[r,i,t]=this.readEntityExp(e,t+1,this.suppressValidationErr),i.indexOf(`&`)===-1&&(n[r]={regx:RegExp(`&${r};`,`g`),val:i})}else if(i&&C(e,`!ELEMENT`,t)){t+=8;let{index:n}=this.readElementExp(e,t+1);t=n}else if(i&&C(e,`!ATTLIST`,t))t+=8;else if(i&&C(e,`!NOTATION`,t)){t+=9;let{index:n}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=n}else if(C(e,`!--`,t))a=!0;else throw Error(`Invalid DOCTYPE`);r++,o=``}else if(e[t]===`>`){if(a?e[t-1]===`-`&&e[t-2]===`-`&&(a=!1,r--):r--,r===0)break}else e[t]===`[`?i=!0:o+=e[t];if(r!==0)throw Error(`Unclosed DOCTYPE`)}else throw Error(`Invalid Tag instead of DOCTYPE`);return{entities:n,i:t}}readEntityExp(e,t){t=S(e,t);let n=``;for(;t<e.length&&!/\s/.test(e[t])&&e[t]!==`"`&&e[t]!==`'`;)n+=e[t],t++;if(w(n),t=S(e,t),!this.suppressValidationErr){if(e.substring(t,t+6).toUpperCase()===`SYSTEM`)throw Error(`External entities are not supported`);if(e[t]===`%`)throw Error(`Parameter entities are not supported`)}let r=``;return[t,r]=this.readIdentifierVal(e,t,`entity`),t--,[n,r,t]}readNotationExp(e,t){t=S(e,t);let n=``;for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;!this.suppressValidationErr&&w(n),t=S(e,t);let r=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&r!==`SYSTEM`&&r!==`PUBLIC`)throw Error(`Expected SYSTEM or PUBLIC, found "${r}"`);t+=r.length,t=S(e,t);let i=null,a=null;if(r===`PUBLIC`)[t,i]=this.readIdentifierVal(e,t,`publicIdentifier`),t=S(e,t),(e[t]===`"`||e[t]===`'`)&&([t,a]=this.readIdentifierVal(e,t,`systemIdentifier`));else if(r===`SYSTEM`&&([t,a]=this.readIdentifierVal(e,t,`systemIdentifier`),!this.suppressValidationErr&&!a))throw Error(`Missing mandatory system identifier for SYSTEM notation`);return{notationName:n,publicIdentifier:i,systemIdentifier:a,index:--t}}readIdentifierVal(e,t,n){let r=``,i=e[t];if(i!==`"`&&i!==`'`)throw Error(`Expected quoted string, found "${i}"`);for(t++;t<e.length&&e[t]!==i;)r+=e[t],t++;if(e[t]!==i)throw Error(`Unterminated ${n} value`);return t++,[t,r]}readElementExp(e,t){t=S(e,t);let n=``;for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;if(!this.suppressValidationErr&&!l(n))throw Error(`Invalid element name: "${n}"`);t=S(e,t);let r=``;if(e[t]===`E`&&C(e,`MPTY`,t))t+=4;else if(e[t]===`A`&&C(e,`NY`,t))t+=2;else if(e[t]===`(`){for(t++;t<e.length&&e[t]!==`)`;)r+=e[t],t++;if(e[t]!==`)`)throw Error(`Unterminated content model`)}else if(!this.suppressValidationErr)throw Error(`Invalid Element Expression, found "${e[t]}"`);return{elementName:n,contentModel:r.trim(),index:t}}readAttlistExp(e,t){t=S(e,t);let n=``;for(;t<e.length&&!/\s/.test(e[t]);)n+=e[t],t++;w(n),t=S(e,t);let r=``;for(;t<e.length&&!/\s/.test(e[t]);)r+=e[t],t++;if(!w(r))throw Error(`Invalid attribute name: "${r}"`);t=S(e,t);let i=``;if(e.substring(t,t+8).toUpperCase()===`NOTATION`){if(i=`NOTATION`,t+=8,t=S(e,t),e[t]!==`(`)throw Error(`Expected '(', found "${e[t]}"`);t++;let n=[];for(;t<e.length&&e[t]!==`)`;){let r=``;for(;t<e.length&&e[t]!==`|`&&e[t]!==`)`;)r+=e[t],t++;if(r=r.trim(),!w(r))throw Error(`Invalid notation name: "${r}"`);n.push(r),e[t]===`|`&&(t++,t=S(e,t))}if(e[t]!==`)`)throw Error(`Unterminated list of notations`);t++,i+=` (`+n.join(`|`)+`)`}else{for(;t<e.length&&!/\s/.test(e[t]);)i+=e[t],t++;if(!this.suppressValidationErr&&![`CDATA`,`ID`,`IDREF`,`IDREFS`,`ENTITY`,`ENTITIES`,`NMTOKEN`,`NMTOKENS`].includes(i.toUpperCase()))throw Error(`Invalid attribute type: "${i}"`)}t=S(e,t);let a=``;return e.substring(t,t+8).toUpperCase()===`#REQUIRED`?(a=`#REQUIRED`,t+=8):e.substring(t,t+7).toUpperCase()===`#IMPLIED`?(a=`#IMPLIED`,t+=7):[t,a]=this.readIdentifierVal(e,t,`ATTLIST`),{elementName:n,attributeName:r,attributeType:i,defaultValue:a,index:t}}},S=(e,t)=>{for(;t<e.length&&/\s/.test(e[t]);)t++;return t};function C(e,t,n){for(let r=0;r<t.length;r++)if(t[r]!==e[n+r+1])return!1;return!0}function w(e){if(l(e))return e;throw Error(`Invalid entity name ${e}`)}var de=/^[-+]?0x[a-fA-F0-9]+$/,fe=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,pe={hex:!0,leadingZeros:!0,decimalPoint:`.`,eNotation:!0};function me(e,t={}){if(t=Object.assign({},pe,t),!e||typeof e!=`string`)return e;let n=e.trim();if(t.skipLike!==void 0&&t.skipLike.test(n))return e;if(e===`0`)return 0;if(t.hex&&de.test(n))return E(n,16);if(n.includes(`e`)||n.includes(`E`))return ge(e,n,t);{let r=fe.exec(n);if(r){let i=r[1]||``,a=r[2],o=T(r[3]),s=i?e[a.length+1]===`.`:e[a.length]===`.`;if(!t.leadingZeros&&(a.length>1||a.length===1&&!s))return e;{let r=Number(n),s=String(r);if(r===0)return r;if(s.search(/[eE]/)!==-1)return t.eNotation?r:e;if(n.indexOf(`.`)!==-1)return s===`0`||s===o||s===`${i}${o}`?r:e;let c=a?o:n;return a?c===s||i+c===s?r:e:c===s||c===i+s?r:e}}else return e}}var he=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function ge(e,t,n){if(!n.eNotation)return e;let r=t.match(he);if(r){let i=r[1]||``,a=r[3].indexOf(`e`)===-1?`E`:`e`,o=r[2],s=i?e[o.length+1]===a:e[o.length]===a;return o.length>1&&s?e:o.length===1&&(r[3].startsWith(`.${a}`)||r[3][0]===a)?Number(t):n.leadingZeros&&!s?(t=(r[1]||``)+r[3],Number(t)):e}else return e}function T(e){return e&&e.indexOf(`.`)!==-1?(e=e.replace(/0+$/,``),e===`.`?e=`0`:e[0]===`.`?e=`0`+e:e[e.length-1]===`.`&&(e=e.substring(0,e.length-1)),e):e}function E(e,t){if(parseInt)return parseInt(e,t);if(Number.parseInt)return Number.parseInt(e,t);if(window&&window.parseInt)return window.parseInt(e,t);throw Error(`parseInt, Number.parseInt, window.parseInt are not supported`)}function D(e){return typeof e==`function`?e:Array.isArray(e)?t=>{for(let n of e)if(typeof n==`string`&&t===n||n instanceof RegExp&&n.test(t))return!0}:()=>!1}var O=class{constructor(e){if(this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:`'`},gt:{regex:/&(gt|#62|#x3E);/g,val:`>`},lt:{regex:/&(lt|#60|#x3C);/g,val:`<`},quot:{regex:/&(quot|#34|#x22);/g,val:`"`}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:`&`},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:` `},cent:{regex:/&(cent|#162);/g,val:`¢`},pound:{regex:/&(pound|#163);/g,val:`£`},yen:{regex:/&(yen|#165);/g,val:`¥`},euro:{regex:/&(euro|#8364);/g,val:`€`},copyright:{regex:/&(copy|#169);/g,val:`©`},reg:{regex:/&(reg|#174);/g,val:`®`},inr:{regex:/&(inr|#8377);/g,val:`₹`},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCodePoint(Number.parseInt(t,16))}},this.addExternalEntities=k,this.parseXml=P,this.parseTextData=A,this.resolveNameSpace=j,this.buildAttributesMap=N,this.isItStopNode=_e,this.replaceEntitiesValue=I,this.readStopNodeData=ye,this.saveTextToParentTag=L,this.addChild=F,this.ignoreAttributesFn=D(this.options.ignoreAttributes),this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set,this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){let t=this.options.stopNodes[e];typeof t==`string`&&(t.startsWith(`*.`)?this.stopNodesWildcard.add(t.substring(2)):this.stopNodesExact.add(t))}}}};function k(e){let t=Object.keys(e);for(let n=0;n<t.length;n++){let r=t[n];this.lastEntities[r]={regex:RegExp(`&`+r+`;`,`g`),val:e[r]}}}function A(e,t,n,r,i,a,o){if(e!==void 0&&(this.options.trimValues&&!r&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));let r=this.options.tagValueProcessor(t,e,n,i,a);return r==null?e:typeof r!=typeof e||r!==e?r:this.options.trimValues||e.trim()===e?B(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function j(e){if(this.options.removeNSPrefix){let t=e.split(`:`),n=e.charAt(0)===`/`?`/`:``;if(t[0]===`xmlns`)return``;t.length===2&&(e=n+t[1])}return e}var M=RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,`gm`);function N(e,t){if(this.options.ignoreAttributes!==!0&&typeof e==`string`){let n=c(e,M),r=n.length,i={};for(let e=0;e<r;e++){let r=this.resolveNameSpace(n[e][1]);if(this.ignoreAttributesFn(r,t))continue;let a=n[e][4],o=this.options.attributeNamePrefix+r;if(r.length)if(this.options.transformAttributeName&&(o=this.options.transformAttributeName(o)),o===`__proto__`&&(o=`#__proto__`),a!==void 0){this.options.trimValues&&(a=a.trim()),a=this.replaceEntitiesValue(a);let e=this.options.attributeValueProcessor(r,a,t);e==null?i[o]=a:typeof e!=typeof a||e!==a?i[o]=e:i[o]=B(a,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(i[o]=!0)}if(!Object.keys(i).length)return;if(this.options.attributesGroupName){let e={};return e[this.options.attributesGroupName]=i,e}return i}}var P=function(e){e=e.replace(/\r\n?/g,`
`);let t=new x(`!xml`),n=t,r=``,i=``,a=new ue(this.options.processEntities);for(let o=0;o<e.length;o++)if(e[o]===`<`)if(e[o+1]===`/`){let t=R(e,`>`,o,`Closing Tag is not closed.`),a=e.substring(o+2,t).trim();if(this.options.removeNSPrefix){let e=a.indexOf(`:`);e!==-1&&(a=a.substr(e+1))}this.options.transformTagName&&(a=this.options.transformTagName(a)),n&&(r=this.saveTextToParentTag(r,n,i));let s=i.substring(i.lastIndexOf(`.`)+1);if(a&&this.options.unpairedTags.indexOf(a)!==-1)throw Error(`Unpaired tag can not be used as closing tag: </${a}>`);let c=0;s&&this.options.unpairedTags.indexOf(s)!==-1?(c=i.lastIndexOf(`.`,i.lastIndexOf(`.`)-1),this.tagsNodeStack.pop()):c=i.lastIndexOf(`.`),i=i.substring(0,c),n=this.tagsNodeStack.pop(),r=``,o=t}else if(e[o+1]===`?`){let t=z(e,o,!1,`?>`);if(!t)throw Error(`Pi Tag is not closed.`);if(r=this.saveTextToParentTag(r,n,i),!(this.options.ignoreDeclaration&&t.tagName===`?xml`||this.options.ignorePiTags)){let e=new x(t.tagName);e.add(this.options.textNodeName,``),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[`:@`]=this.buildAttributesMap(t.tagExp,i)),this.addChild(n,e,i,o)}o=t.closeIndex+1}else if(e.substr(o+1,3)===`!--`){let t=R(e,`-->`,o+4,`Comment is not closed.`);if(this.options.commentPropName){let a=e.substring(o+4,t-2);r=this.saveTextToParentTag(r,n,i),n.add(this.options.commentPropName,[{[this.options.textNodeName]:a}])}o=t}else if(e.substr(o+1,2)===`!D`){let t=a.readDocType(e,o);this.docTypeEntities=t.entities,o=t.i}else if(e.substr(o+1,2)===`![`){let t=R(e,`]]>`,o,`CDATA is not closed.`)-2,a=e.substring(o+9,t);r=this.saveTextToParentTag(r,n,i);let s=this.parseTextData(a,n.tagname,i,!0,!1,!0,!0);s??=``,this.options.cdataPropName?n.add(this.options.cdataPropName,[{[this.options.textNodeName]:a}]):n.add(this.options.textNodeName,s),o=t+2}else{let a=z(e,o,this.options.removeNSPrefix),s=a.tagName,c=a.rawTagName,l=a.tagExp,u=a.attrExpPresent,d=a.closeIndex;if(this.options.transformTagName){let e=this.options.transformTagName(s);l===s&&(l=e),s=e}n&&r&&n.tagname!==`!xml`&&(r=this.saveTextToParentTag(r,n,i,!1));let f=n;f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(n=this.tagsNodeStack.pop(),i=i.substring(0,i.lastIndexOf(`.`))),s!==t.tagname&&(i+=i?`.`+s:s);let p=o;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,i,s)){let t=``;if(l.length>0&&l.lastIndexOf(`/`)===l.length-1)s[s.length-1]===`/`?(s=s.substr(0,s.length-1),i=i.substr(0,i.length-1),l=s):l=l.substr(0,l.length-1),o=a.closeIndex;else if(this.options.unpairedTags.indexOf(s)!==-1)o=a.closeIndex;else{let n=this.readStopNodeData(e,c,d+1);if(!n)throw Error(`Unexpected end of ${c}`);o=n.i,t=n.tagContent}let r=new x(s);s!==l&&u&&(r[`:@`]=this.buildAttributesMap(l,i)),t&&=this.parseTextData(t,s,i,!0,u,!0,!0),i=i.substr(0,i.lastIndexOf(`.`)),r.add(this.options.textNodeName,t),this.addChild(n,r,i,p)}else{if(l.length>0&&l.lastIndexOf(`/`)===l.length-1){if(s[s.length-1]===`/`?(s=s.substr(0,s.length-1),i=i.substr(0,i.length-1),l=s):l=l.substr(0,l.length-1),this.options.transformTagName){let e=this.options.transformTagName(s);l===s&&(l=e),s=e}let e=new x(s);s!==l&&u&&(e[`:@`]=this.buildAttributesMap(l,i)),this.addChild(n,e,i,p),i=i.substr(0,i.lastIndexOf(`.`))}else{let e=new x(s);this.tagsNodeStack.push(n),s!==l&&u&&(e[`:@`]=this.buildAttributesMap(l,i)),this.addChild(n,e,i,p),n=e}r=``,o=d}}else r+=e[o];return t.child};function F(e,t,n,r){this.options.captureMetaData||(r=void 0);let i=this.options.updateTag(t.tagname,n,t[`:@`]);i===!1||(typeof i==`string`&&(t.tagname=i),e.addChild(t,r))}var I=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){let n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){let n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){let n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function L(e,t,n,r){return e&&=(r===void 0&&(r=t.child.length===0),e=this.parseTextData(e,t.tagname,n,!1,t[`:@`]?Object.keys(t[`:@`]).length!==0:!1,r),e!==void 0&&e!==``&&t.add(this.options.textNodeName,e),``),e}function _e(e,t,n,r){return!!(t&&t.has(r)||e&&e.has(n))}function ve(e,t,n=`>`){let r,i=``;for(let a=t;a<e.length;a++){let t=e[a];if(r)t===r&&(r=``);else if(t===`"`||t===`'`)r=t;else if(t===n[0])if(n[1]){if(e[a+1]===n[1])return{data:i,index:a}}else return{data:i,index:a};else t===`	`&&(t=` `);i+=t}}function R(e,t,n,r){let i=e.indexOf(t,n);if(i===-1)throw Error(r);return i+t.length-1}function z(e,t,n,r=`>`){let i=ve(e,t+1,r);if(!i)return;let a=i.data,o=i.index,s=a.search(/\s/),c=a,l=!0;s!==-1&&(c=a.substring(0,s),a=a.substring(s+1).trimStart());let u=c;if(n){let e=c.indexOf(`:`);e!==-1&&(c=c.substr(e+1),l=c!==i.data.substr(e+1))}return{tagName:c,tagExp:a,closeIndex:o,attrExpPresent:l,rawTagName:u}}function ye(e,t,n){let r=n,i=1;for(;n<e.length;n++)if(e[n]===`<`)if(e[n+1]===`/`){let a=R(e,`>`,n,`${t} is not closed`);if(e.substring(n+2,a).trim()===t&&(i--,i===0))return{tagContent:e.substring(r,n),i:a};n=a}else if(e[n+1]===`?`)n=R(e,`?>`,n+1,`StopNode is not closed.`);else if(e.substr(n+1,3)===`!--`)n=R(e,`-->`,n+3,`StopNode is not closed.`);else if(e.substr(n+1,2)===`![`)n=R(e,`]]>`,n,`StopNode is not closed.`)-2;else{let r=z(e,n,`>`);r&&((r&&r.tagName)===t&&r.tagExp[r.tagExp.length-1]!==`/`&&i++,n=r.closeIndex)}}function B(e,t,n){if(t&&typeof e==`string`){let t=e.trim();return t===`true`?!0:t===`false`?!1:me(e,n)}else if(u(e))return e;else return``}var V=x.getMetaDataSymbol();function be(e,t){return H(e,t)}function H(e,t,n){let r,i={};for(let a=0;a<e.length;a++){let o=e[a],s=xe(o),c=``;if(c=n===void 0?s:n+`.`+s,s===t.textNodeName)r===void 0?r=o[s]:r+=``+o[s];else if(s===void 0)continue;else if(o[s]){let e=H(o[s],t,c),n=Ce(e,t);o[V]!==void 0&&(e[V]=o[V]),o[`:@`]?Se(e,o[`:@`],c,t):Object.keys(e).length===1&&e[t.textNodeName]!==void 0&&!t.alwaysCreateTextNode?e=e[t.textNodeName]:Object.keys(e).length===0&&(t.alwaysCreateTextNode?e[t.textNodeName]=``:e=``),i[s]!==void 0&&i.hasOwnProperty(s)?(Array.isArray(i[s])||(i[s]=[i[s]]),i[s].push(e)):t.isArray(s,c,n)?i[s]=[e]:i[s]=e}}return typeof r==`string`?r.length>0&&(i[t.textNodeName]=r):r!==void 0&&(i[t.textNodeName]=r),i}function xe(e){let t=Object.keys(e);for(let e=0;e<t.length;e++){let n=t[e];if(n!==`:@`)return n}}function Se(e,t,n,r){if(t){let i=Object.keys(t),a=i.length;for(let o=0;o<a;o++){let a=i[o];r.isArray(a,n+`.`+a,!0,!0)?e[a]=[t[a]]:e[a]=t[a]}}}function Ce(e,t){let{textNodeName:n}=t,r=Object.keys(e).length;return!!(r===0||r===1&&(e[n]||typeof e[n]==`boolean`||e[n]===0))}var we=class{constructor(e){this.externalEntities={},this.options=le(e)}parse(e,t){if(typeof e!=`string`&&e.toString)e=e.toString();else if(typeof e!=`string`)throw Error(`XML data is accepted in String or Bytes[] form.`);if(t){t===!0&&(t={});let n=f(e,t);if(n!==!0)throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}let n=new O(this.options);n.addExternalEntities(this.externalEntities);let r=n.parseXml(e);return this.options.preserveOrder||r===void 0?r:be(r,this.options)}addEntity(e,t){if(t.indexOf(`&`)!==-1)throw Error(`Entity value can't have '&'`);if(e.indexOf(`&`)!==-1||e.indexOf(`;`)!==-1)throw Error(`An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'`);if(t===`&`)throw Error(`An entity with value '&' is not permitted`);this.externalEntities[e]=t}static getMetaDataSymbol(){return x.getMetaDataSymbol()}},U=t(e(),1),Te=new we({ignoreAttributes:!1,allowBooleanAttributes:!0,trimValues:!0,cdataPropName:`__cdata`});function W(e){return typeof e==`object`&&!!e}function G(e){let t=e.trim();if(!t)return null;try{return JSON.parse(t)}catch{return null}}function K(e){if(!W(e))return{raw:e};let t=typeof e.kaiSignature==`string`?e.kaiSignature:void 0,n=typeof e.pulse==`number`&&Number.isFinite(e.pulse)?e.pulse:void 0,r=typeof e.beat==`number`&&Number.isFinite(e.beat)?e.beat:void 0,i=typeof e.stepIndex==`number`&&Number.isFinite(e.stepIndex)?e.stepIndex:void 0,a=typeof e.frequencyHz==`number`&&Number.isFinite(e.frequencyHz)?e.frequencyHz:void 0,o=typeof e.chakraDay==`string`?e.chakraDay:void 0,s=typeof e.chakraGate==`string`?e.chakraGate:void 0,c=typeof e.timestamp==`string`?e.timestamp:void 0,l=typeof e.phiKey==`string`?e.phiKey:void 0,u=typeof e.userPhiKey==`string`?e.userPhiKey:void 0;return{pulse:n,beat:r,stepIndex:i,frequencyHz:a,chakraDay:o,chakraGate:s,kaiSignature:t,phiKey:l&&!l.startsWith(`φK-`)?l:u,timestamp:c,verifierUrl:typeof e.verifierUrl==`string`?e.verifierUrl:void 0,raw:e}}function q(e,t){if(typeof e==`string`){t.push(e);return}if(W(e)){typeof e.__cdata==`string`&&t.push(e.__cdata);for(let n of Object.values(e))q(n,t)}}function Ee(e,t,n=2e3){let r=Math.max(0,t-n),i=Math.min(e.length,t+n),a=e.slice(r,i),o=t-r,s=[],c=[],l=!1,u=!1;for(let e=0;e<a.length;e+=1){let t=a[e];if(l){if(u){u=!1;continue}if(t===`\\`){u=!0;continue}t===`"`&&(l=!1);continue}if(t===`"`){l=!0;continue}if(t===`{`){c.push(e);continue}if(t===`}`){let t=c.pop();if(t==null)continue;t<=o&&e>=o&&s.push({start:t,end:e})}}return s.sort((e,t)=>t.end-t.start-(e.end-e.start)),s.map(({start:e,end:t})=>a.slice(e,t+1))}function J(e){let t=G(e);if(t){let e=K(t);if(e.kaiSignature)return e}let n=[...e.matchAll(/"kaiSignature"\s*:/g)];if(!n.length)return null;for(let t of n){let n=Ee(e,t.index??0);for(let e of n){if(!e.includes(`"kaiSignature"`))continue;let t=G(e);if(!t)continue;let n=K(t);if(n.kaiSignature)return n}}return null}function De(e){let t=W(e.svg)?e.svg:e,n=[];W(t.metadata)?q(t.metadata,n):typeof t.metadata==`string`&&n.push(t.metadata),W(t.desc)?q(t.desc,n):typeof t.desc==`string`&&n.push(t.desc);for(let e of n){let t=J(e);if(t)return t}return null}function Y(e,t){let n=`${t}\\s*=\\s*(\"([^\"]*)\"|'([^']*)')`,r=e.match(new RegExp(n,`i`));if(r)return r[2]??r[3]}function X(e,t){let n=Y(e,t);if(!n)return;let r=Number(n);return Number.isFinite(r)?r:void 0}function Oe(e){let t=X(e,`data-pulse`),n=X(e,`data-beat`),r=X(e,`data-step-index`),i=X(e,`data-frequency-hz`),a=Y(e,`data-chakra-gate`);return{pulse:t,beat:n,stepIndex:r,frequencyHz:i,chakraDay:Y(e,`data-harmonic-day`)??Y(e,`data-chakra-day`),chakraGate:a,kaiSignature:Y(e,`data-kai-signature`),phiKey:Y(e,`data-phi-key`)}}function Z(e,t){let n={...e};for(let[e,r]of Object.entries(t))r!==void 0&&(n[e]??(n[e]=r));return n}function ke(e){let t=Oe(e);try{let n=Te.parse(e);if(W(n)){let e=De(n);if(e)return Z(e,t)}}catch(e){console.warn(`sigilMetadata: failed to parse SVG`,e)}let n=J(e);return n?Z(n,t):t}function Ae(e){let t=decodeURIComponent(e||``).trim(),n=t.match(/^(\d+)-([A-Za-z0-9]+)$/);if(!n)return{raw:t,pulse:null,shortSig:null};let r=Number(n[1]);return{raw:t,pulse:Number.isFinite(r)&&r>0?r:null,shortSig:n[2]?String(n[2]):null}}function je(e,t){return e.length<=t?e:e.slice(0,t)}async function Q(e,t){try{let r=ke(t),i=(r.kaiSignature??``).trim();if(!i)return{status:`error`,message:`No kaiSignature found in the SVG metadata.`,slug:e,embedded:r};let a=await n(i),o=(r.phiKey??``).trim(),s=r.pulse,c={hasSignature:!0,slugPulseMatches:e.pulse==null||s==null?null:e.pulse===s,slugShortSigMatches:e.shortSig==null?null:e.shortSig===je(i,e.shortSig.length),derivedPhiKeyMatchesEmbedded:o.length===0?null:a===o};return c.slugPulseMatches===!1||c.slugShortSigMatches===!1||c.derivedPhiKeyMatchesEmbedded===!1?{status:`error`,message:`Verification failed: one or more checks did not match.`,slug:e,embedded:r,derivedPhiKey:a,checks:c}:{status:`ok`,slug:e,embedded:{...r,phiKey:o.length>0?o:a},derivedPhiKey:a,checks:c}}catch(t){return{status:`error`,message:t instanceof Error?t.message:`Verification failed.`,slug:e}}}var $=t(r(),1);function Me(){if(typeof window>`u`)return``;let e=window.location.pathname||``,t=window.location.hash||``,n=e.match(/\/verify\/([^/?#]+)/);if(n&&n[1])return n[1];let r=t.match(/\/verify\/([^/?#]+)/);return r&&r[1]?r[1]:``}async function Ne(e){return await new Promise((t,n)=>{let r=new FileReader;r.onerror=()=>n(Error(`Failed to read file.`)),r.onload=()=>t(String(r.result??``)),r.readAsText(e)})}function Pe(){let e=(0,U.useMemo)(()=>Me(),[]),t=(0,U.useMemo)(()=>Ae(e),[e]),[n,r]=(0,U.useState)(``),[a,o]=(0,U.useState)({status:`idle`}),[s,c]=(0,U.useState)(!1),l=(0,U.useMemo)(()=>({pulse:t.pulse??0,kaiSignature:t.shortSig??`unknown-signature`,phiKey:`—`}),[t.pulse,t.shortSig]),u=(0,U.useCallback)(async()=>{let e=n.trim();if(!e){o({status:`error`,message:`Paste the sealed SVG text or upload the sealed SVG file first.`,slug:t});return}c(!0);try{o(await Q(t,e))}finally{c(!1)}},[t,n]),d=(0,U.useCallback)(async e=>{if(!e.name.toLowerCase().endsWith(`.svg`)){o({status:`error`,message:`Upload a sealed .svg (this verifier reads embedded <metadata> JSON).`,slug:t});return}r(await Ne(e)),o({status:`idle`})},[t]);return(0,$.jsxs)(`div`,{className:`verify-page`,children:[(0,$.jsxs)(`header`,{className:`verify-hero`,children:[(0,$.jsx)(`h1`,{className:`verify-title`,children:`Kai-Sigil Verifier`}),(0,$.jsx)(`p`,{className:`verify-subtitle`,children:`Open a sealed memory and verify its human origin by Kai Signature → Φ-Key.`}),(0,$.jsxs)(`div`,{className:`verify-slug`,children:[(0,$.jsx)(`span`,{className:`verify-slug-label`,children:`Link:`}),(0,$.jsxs)(`code`,{className:`verify-slug-value`,children:[`/verify/`,t.raw||`—`]})]})]}),(0,$.jsxs)(`main`,{className:`verify-main`,children:[(0,$.jsxs)(`section`,{className:`verify-card`,children:[(0,$.jsx)(`h2`,{className:`verify-card-title`,children:`1) Provide the sealed post`}),(0,$.jsxs)(`div`,{className:`verify-upload-row`,children:[(0,$.jsxs)(`label`,{className:`verify-upload`,children:[(0,$.jsx)(`input`,{type:`file`,accept:`.svg,image/svg+xml`,onChange:e=>{let t=e.currentTarget.files?.[0];t&&d(t),e.currentTarget.value=``}}),`Upload sealed SVG`]}),(0,$.jsx)(`button`,{type:`button`,className:`verify-btn`,onClick:()=>void u(),disabled:s,children:s?`Verifying…`:`Verify`})]}),(0,$.jsx)(`textarea`,{className:`verify-textarea`,value:n,onChange:e=>r(e.currentTarget.value),placeholder:`Or paste the sealed SVG text here (must include <metadata>{...}</metadata> with kaiSignature + pulse + userPhiKey/phiKey).`,spellCheck:!1})]}),(0,$.jsxs)(`section`,{className:`verify-card`,children:[(0,$.jsx)(`h2`,{className:`verify-card-title`,children:`2) Proof capsule`}),a.status===`ok`?(0,$.jsx)(i,{pulse:a.embedded.pulse??t.pulse??0,kaiSignature:a.embedded.kaiSignature??t.shortSig??`unknown`,phiKey:a.derivedPhiKey,chakraDay:a.embedded.chakraDay,compact:!1}):(0,$.jsx)(i,{pulse:l.pulse,kaiSignature:l.kaiSignature,phiKey:l.phiKey,compact:!1}),(0,$.jsx)(`div`,{className:`verify-status`,children:a.status===`idle`?(0,$.jsx)(`p`,{className:`verify-muted`,children:`Upload/paste a sealed SVG, then click Verify.`}):a.status===`ok`?(0,$.jsxs)(`div`,{className:`verify-ok`,children:[(0,$.jsx)(`div`,{className:`verify-badge verify-badge--ok`,children:`Verified`}),(0,$.jsxs)(`p`,{className:`verify-line`,children:[`Sealed by Φ-Key: `,(0,$.jsx)(`code`,{children:a.derivedPhiKey})]}),(0,$.jsxs)(`ul`,{className:`verify-checks`,children:[(0,$.jsxs)(`li`,{children:[`slug pulse match:`,` `,(0,$.jsx)(`strong`,{children:a.checks.slugPulseMatches===null?`n/a`:String(a.checks.slugPulseMatches)})]}),(0,$.jsxs)(`li`,{children:[`slug shortSig match:`,` `,(0,$.jsx)(`strong`,{children:a.checks.slugShortSigMatches===null?`n/a`:String(a.checks.slugShortSigMatches)})]}),(0,$.jsxs)(`li`,{children:[`derived Φ-Key matches embedded:`,` `,(0,$.jsx)(`strong`,{children:a.checks.derivedPhiKeyMatchesEmbedded===null?`n/a (embed omitted phiKey)`:String(a.checks.derivedPhiKeyMatchesEmbedded)})]})]})]}):(0,$.jsxs)(`div`,{className:`verify-fail`,children:[(0,$.jsx)(`div`,{className:`verify-badge verify-badge--fail`,children:`Not verified`}),(0,$.jsx)(`p`,{className:`verify-line`,children:a.message}),a.checks?(0,$.jsxs)(`ul`,{className:`verify-checks`,children:[(0,$.jsxs)(`li`,{children:[`slug pulse match:`,` `,(0,$.jsx)(`strong`,{children:a.checks.slugPulseMatches===null?`n/a`:String(a.checks.slugPulseMatches)})]}),(0,$.jsxs)(`li`,{children:[`slug shortSig match:`,` `,(0,$.jsx)(`strong`,{children:a.checks.slugShortSigMatches===null?`n/a`:String(a.checks.slugShortSigMatches)})]}),(0,$.jsxs)(`li`,{children:[`derived Φ-Key matches embedded:`,` `,(0,$.jsx)(`strong`,{children:a.checks.derivedPhiKeyMatchesEmbedded===null?`n/a (embed omitted phiKey)`:String(a.checks.derivedPhiKeyMatchesEmbedded)})]})]}):null]})})]})]})]})}export{Pe as default};