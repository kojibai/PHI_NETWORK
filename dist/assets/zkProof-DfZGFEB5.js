function e(e){return typeof e==`object`&&!!e&&Object.keys(e).length>0}async function t(t){let n=t.poseidonHash?.trim();if(!n)return null;try{if(typeof fetch!=`function`)return null;let r=await fetch(`/api/proof/sigil`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({secret:t.secret??n,expectedHash:n})});if(!r.ok)throw Error(`ZK proof API failed`);let i=await r.json();if(!i||!e(i))return null;let a=i.zkProof;if(!e(a))throw Error(`ZK proof missing`);let o=Array.isArray(i.zkPublicInputs)?i.zkPublicInputs.map(e=>String(e)):[];if(!o.length)throw Error(`ZK public input missing`);if(o[0]!==n)throw Error(`ZK public input mismatch`);let s={scheme:`groth16-poseidon`,api:`/api/proof/sigil`,explorer:`/keystream/hash/${n}`,...t.proofHints??{},...i.proofHints??{}};return{proof:a??null,proofHints:s,zkPublicInputs:o}}catch{return null}}export{t};