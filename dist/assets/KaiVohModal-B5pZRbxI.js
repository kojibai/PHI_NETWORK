const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/KaiVohApp-CQRs60xk.js","assets/index-BB2Samwe.js","assets/index-DIbPwWUC.css","assets/browser-BhMlLk_3.js","assets/SigilAuthContext-CUJJGoEs.js","assets/ticker-oYruxt7A.js","assets/ticker-B0glx6FE.css","assets/VerifierFrame-DquqW0s7.js","assets/VerifierFrame-CSoanQJ_.css","assets/sessionStorage-CKL6_xzc.js","assets/postSeal-DE4BCNSp.js","assets/webauthnKAS-hbJtNGMt.js","assets/KaiVohApp-Brroi08x.css","assets/KaiRealms-BXCbggJW.js","assets/x-CcvQOTJN.js","assets/KaiRealms-BZJvSAmB.css"])))=>i.map(i=>d[i]);
import{t as e}from"./x-CcvQOTJN.js";import{di as t,hi as n,pi as r,qt as i,t as a,xi as o}from"./index-BB2Samwe.js";import{t as s}from"./SigilAuthContext-CUJJGoEs.js";import{n as c}from"./sessionStorage-CKL6_xzc.js";import{t as l}from"./SigilAuthProvider-BckYHE1_.js";var u=o(r(),1),d=o(n(),1),f=o(i(),1),p=class extends d.Component{state={error:null};static getDerivedStateFromError(e){return{error:e}}componentDidCatch(e,t){console.error(`[KaiVoh] render error:`,e,t)}render(){return this.state.error?(0,f.jsxs)(`div`,{style:{padding:`1rem`,textAlign:`center`},children:[(0,f.jsx)(`h2`,{style:{fontSize:18,fontWeight:600},children:`KaiVoh failed to load`}),(0,f.jsx)(`p`,{style:{opacity:.8,marginTop:8},children:this.state.error.message}),(0,f.jsxs)(`details`,{style:{opacity:.65,marginTop:12,textAlign:`left`},children:[(0,f.jsx)(`summary`,{children:`Details`}),(0,f.jsx)(`pre`,{style:{whiteSpace:`pre-wrap`},children:String(this.state.error.stack??``)})]})]}):this.props.children}};function m(){let e=(0,d.useContext)(s);if(!e)throw Error(`useSigilAuth must be used inside <SigilAuthProvider>`);return e}var h=(0,d.lazy)(()=>t(()=>import(`./KaiVohApp-CQRs60xk.js`),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),g=(0,d.lazy)(()=>t(()=>import(`./KaiRealms-BXCbggJW.js`),__vite__mapDeps([13,1,2,14,15]))),_=(1+Math.sqrt(5))/2,v=5.236,y=610,b=377;function x({className:e}){let t=(0,d.useId)();return(0,f.jsxs)(`svg`,{className:e,width:y,height:b,viewBox:`0 0 ${y} ${b}`,"aria-hidden":`true`,focusable:`false`,children:[(0,f.jsx)(`defs`,{children:(0,f.jsxs)(`linearGradient`,{id:t,x1:`0`,y1:`0`,x2:`1`,y2:`1`,children:[(0,f.jsx)(`stop`,{offset:`0%`,stopColor:`currentColor`,stopOpacity:`0.0`}),(0,f.jsx)(`stop`,{offset:`40%`,stopColor:`currentColor`,stopOpacity:`0.5`}),(0,f.jsx)(`stop`,{offset:`100%`,stopColor:`currentColor`,stopOpacity:`0.0`})]})}),(0,f.jsxs)(`g`,{fill:`none`,stroke:`url(#${t})`,strokeWidth:`2`,children:[(0,f.jsx)(`path`,{d:`M377 0 A377 377 0 0 1 0 377`}),(0,f.jsx)(`path`,{d:`M233 0 A233 233 0 0 1 0 233`}),(0,f.jsx)(`path`,{d:`M144 0 A144 144 0 0 1 0 144`}),(0,f.jsx)(`path`,{d:`M89 0 A89 89 0 0 1 0 89`}),(0,f.jsx)(`path`,{d:`M55 0 A55 55 0 0 1 0 55`}),(0,f.jsx)(`path`,{d:`M34 0 A34 34 0 0 1 0 34`}),(0,f.jsx)(`path`,{d:`M21 0 A21 21 0 0 1 0 21`})]})]})}function S({className:e}){return(0,f.jsxs)(`div`,{className:`seal-emblem ${e??``}`,"aria-hidden":`true`,children:[(0,f.jsx)(`div`,{className:`seal-ring seal-ring--outer`}),(0,f.jsx)(`div`,{className:`seal-ring seal-ring--inner`}),(0,f.jsx)(`div`,{className:`seal-core`})]})}function C({className:e}){let{auth:t}=m(),n=t.meta;if(!n)return null;let r=[`Pulse: ${n.pulse}`,`Beat: ${n.beat}`,`Step: ${n.stepIndex}`,`Day: ${n.chakraDay}`];return n.sigilId&&r.push(`Sigil: ${n.sigilId}`),n.userPhiKey&&r.push(`PhiKey: ${n.userPhiKey}`),(0,f.jsxs)(`div`,{className:`sigil-auth-pill ${e??``}`,role:`status`,"aria-live":`polite`,title:r.join(` â€¢ `),style:{maxWidth:`100%`,overflowX:`auto`,whiteSpace:`nowrap`},children:[(0,f.jsx)(`span`,{className:`sigil-auth-pill__dot`,"aria-hidden":`true`}),(0,f.jsxs)(`span`,{className:`sigil-auth-pill__text mono`,children:[`Sealed â€¢ `,n.pulse,` â€¢ `,n.chakraDay,n.sigilId?` â€¢ ${n.sigilId}`:``]})]})}function w(e){return e?Array.from(e.querySelectorAll([`a[href]`,`button:not([disabled])`,`input:not([disabled])`,`select:not([disabled])`,`textarea:not([disabled])`,`[tabindex]:not([tabindex='-1'])`].join(`,`))).filter(e=>!e.hasAttribute(`disabled`)&&!e.getAttribute(`aria-hidden`)):[]}function T(e){return e?e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement?!e.disabled:!!(e instanceof HTMLElement&&e.isContentEditable):!1}function E(e){if(!e||e instanceof HTMLTextAreaElement)return!1;if(e instanceof HTMLSelectElement)return!0;if(e instanceof HTMLInputElement){let t=e.type.toLowerCase();return![`button`,`submit`,`reset`,`checkbox`,`radio`,`file`,`range`,`color`].includes(t)}return!1}function D({open:t,onClose:n}){let r=(0,d.useCallback)(()=>{c(),n()},[n]),i=(0,d.useRef)(null),o=(0,d.useRef)(null),s=(0,d.useRef)(null),m=(0,d.useRef)(0),y=(0,d.useRef)(0),[b,D]=(0,d.useState)(`voh`),[O,k]=(0,d.useState)(!1);(0,d.useEffect)(()=>{if(a())return console.log(`[Reload Detective] KaiVohModal mount`),()=>{console.log(`[Reload Detective] KaiVohModal unmount`)}},[]);let A=(0,d.useCallback)(e=>{e===`realms`&&!O&&k(!0),D(e)},[O]),j=(0,d.useMemo)(()=>({breath:`${v}s`,phi:`${_}`}),[]);(0,d.useEffect)(()=>{if(!t)return;let e=!window.matchMedia?.(`(pointer: coarse)`)?.matches,n={bodyOverflow:document.body.style.overflow,bodyPosition:document.body.style.position,bodyTop:document.body.style.top,bodyLeft:document.body.style.left,bodyRight:document.body.style.right,bodyWidth:document.body.style.width,bodyHeight:document.body.style.height,htmlOverflow:document.documentElement.style.overflow,htmlHeight:document.documentElement.style.height,docOverscroll:document.documentElement.style.getPropertyValue(`overscroll-behavior`),bodyOverscroll:document.body.style.getPropertyValue(`overscroll-behavior`),touchAction:document.documentElement.style.touchAction,breath:document.documentElement.style.getPropertyValue(`--kai-breath`),phi:document.documentElement.style.getPropertyValue(`--kai-phi`),kaiVh:document.documentElement.style.getPropertyValue(`--kai-vh`)};y.current=window.scrollY||window.pageYOffset||0,document.body.style.position=`fixed`,document.body.style.top=`-${y.current}px`,document.body.style.left=`0`,document.body.style.right=`0`,document.body.style.width=`100%`,document.body.style.height=`100%`,document.body.style.overflow=`hidden`,document.documentElement.style.overflow=`hidden`,document.documentElement.style.height=`100%`,document.documentElement.style.setProperty(`overscroll-behavior`,`none`),document.body.style.setProperty(`overscroll-behavior`,`none`),document.documentElement.style.touchAction=`manipulation`,document.documentElement.style.setProperty(`--kai-breath`,j.breath),document.documentElement.style.setProperty(`--kai-phi`,j.phi);let a=()=>{document.documentElement.style.setProperty(`--kai-vh`,`${window.innerHeight}px`)};a(),window.addEventListener(`resize`,a,{passive:!0});let c=s.current;c&&(c.style.overscrollBehavior=`contain`,c.style.webkitOverflowScrolling=`touch`),o.current?.focus();let l=e=>{m.current=e.touches[0]?.clientY??0},u=e=>{if(e.touches.length!==1)return;let t=s.current;if(!t){e.preventDefault();return}let n=e.target;if(!(n&&t.contains(n))){e.preventDefault();return}let r=(e.touches[0]?.clientY??m.current)-m.current,i=t.scrollTop<=0,a=t.scrollTop+t.clientHeight>=t.scrollHeight-1;(i&&r>0||a&&r<0)&&e.preventDefault()},d=e=>{let t=s.current;if(!t){e.preventDefault();return}let n=e.target;if(!(n&&t.contains(n))){e.preventDefault();return}let r=e.deltaY,i=t.scrollTop<=0,a=t.scrollTop+t.clientHeight>=t.scrollHeight-1;(i&&r<0||a&&r>0)&&e.preventDefault()},f=t=>{if(t.key===`Escape`){if(!e||T(document.activeElement)||T(t.target))return;t.preventDefault(),t.stopPropagation(),r();return}if(t.key===`Enter`){let e=t.target;E(e)&&i.current?.contains(e)&&t.preventDefault()}if(t.key!==`Tab`)return;let n=i.current,a=w(n);if(a.length===0)return;let o=document.activeElement,s=a[0],c=a[a.length-1];if(!o||!n?.contains(o)){t.preventDefault(),s.focus();return}t.shiftKey?o===s&&(t.preventDefault(),c.focus()):o===c&&(t.preventDefault(),s.focus())},p=new AbortController,h={passive:!0,signal:p.signal,capture:!0},g={passive:!1,signal:p.signal,capture:!0},_={passive:!1,signal:p.signal,capture:!0},v={signal:p.signal,capture:!0};document.addEventListener(`touchstart`,l,h),document.addEventListener(`touchmove`,u,g),document.addEventListener(`wheel`,d,_),document.addEventListener(`keydown`,f,v);let b=e=>{e.preventDefault()};return document.addEventListener(`gesturestart`,b,{passive:!1,signal:p.signal}),document.addEventListener(`gesturechange`,b,{passive:!1,signal:p.signal}),document.addEventListener(`gestureend`,b,{passive:!1,signal:p.signal}),document.addEventListener(`submit`,e=>{let t=e.target;t&&i.current?.contains(t)&&(e.preventDefault(),e.stopPropagation())},{capture:!0,signal:p.signal}),()=>{p.abort(),window.removeEventListener(`resize`,a),document.body.style.overflow=n.bodyOverflow,document.body.style.position=n.bodyPosition,document.body.style.top=n.bodyTop,document.body.style.left=n.bodyLeft,document.body.style.right=n.bodyRight,document.body.style.width=n.bodyWidth,document.body.style.height=n.bodyHeight,document.documentElement.style.overflow=n.htmlOverflow,document.documentElement.style.height=n.htmlHeight,n.docOverscroll?document.documentElement.style.setProperty(`overscroll-behavior`,n.docOverscroll):document.documentElement.style.removeProperty(`overscroll-behavior`),n.bodyOverscroll?document.body.style.setProperty(`overscroll-behavior`,n.bodyOverscroll):document.body.style.removeProperty(`overscroll-behavior`),document.documentElement.style.touchAction=n.touchAction,n.breath?document.documentElement.style.setProperty(`--kai-breath`,n.breath):document.documentElement.style.removeProperty(`--kai-breath`),n.phi?document.documentElement.style.setProperty(`--kai-phi`,n.phi):document.documentElement.style.removeProperty(`--kai-phi`),n.kaiVh?document.documentElement.style.setProperty(`--kai-vh`,n.kaiVh):document.documentElement.style.removeProperty(`--kai-vh`);let e=y.current||0;window.scrollTo(0,e)}},[t,r,j.breath,j.phi]);let M=(0,d.useCallback)(e=>{e.stopPropagation(),r()},[r]),N=(0,d.useCallback)(e=>{(e.key===`Enter`||e.key===` `)&&(e.preventDefault(),e.stopPropagation(),r())},[r]);return t?(0,u.createPortal)((0,f.jsxs)(`div`,{ref:i,className:`kai-voh-modal-backdrop atlantean-veil`,role:`dialog`,"aria-modal":`true`,"aria-labelledby":`kaivoh-title`,"data-view":b,children:[(0,f.jsx)(`div`,{className:`atlantean-stars`,"aria-hidden":`true`}),(0,f.jsx)(`div`,{className:`atlantean-halo atlantean-halo--1`,"aria-hidden":`true`}),(0,f.jsx)(`div`,{className:`atlantean-halo atlantean-halo--2`,"aria-hidden":`true`}),(0,f.jsxs)(`div`,{className:`kai-voh-container kai-pulse-border glass-omni`,role:`document`,children:[(0,f.jsx)(`div`,{className:`breath-ring breath-ring--outer`,"aria-hidden":`true`}),(0,f.jsx)(`div`,{className:`breath-ring breath-ring--inner`,"aria-hidden":`true`}),(0,f.jsx)(`div`,{className:`phi-grid`,"aria-hidden":`true`}),(0,f.jsx)(x,{className:`phi-spiral phi-spiral--tl`}),(0,f.jsx)(x,{className:`phi-spiral phi-spiral--br`}),(0,f.jsxs)(l,{children:[b!==`realms`&&(0,f.jsx)(`button`,{ref:o,type:`button`,className:`kai-voh-close auric-btn`,"aria-label":`Close portal`,onPointerDown:M,onKeyDown:N,children:(0,f.jsx)(e,{size:22,"aria-hidden":`true`})}),b!==`realms`&&(0,f.jsx)(`div`,{className:`voh-top-orb`,"aria-hidden":`true`,children:(0,f.jsx)(S,{})}),(0,f.jsxs)(`div`,{className:`kai-voh-tabbar`,role:`tablist`,"aria-label":`Kai portal views`,children:[(0,f.jsxs)(`button`,{type:`button`,role:`tab`,"aria-selected":b===`voh`,className:`kai-voh-tab auric-tab ${b===`voh`?`active`:``}`,onClick:()=>A(`voh`),children:[(0,f.jsx)(`span`,{className:`tab-glyph`,"aria-hidden":`true`,children:`ðŸœ‚`}),` `,`Voh`]}),(0,f.jsxs)(`button`,{type:`button`,role:`tab`,"aria-selected":b===`realms`,className:`kai-voh-tab auric-tab ${b===`realms`?`active`:``}`,onClick:()=>A(`realms`),children:[(0,f.jsx)(`span`,{className:`tab-glyph`,"aria-hidden":`true`,children:`âšš`}),` `,`Realms`]}),(0,f.jsx)(`div`,{className:`breath-meter`,"aria-hidden":`true`,children:(0,f.jsx)(`div`,{className:`breath-meter__dot`})}),(0,f.jsx)(C,{className:`sigil-auth-pill--tabbar`})]}),(0,f.jsxs)(`div`,{className:`kai-voh-body`,ref:s,children:[(0,f.jsx)(`h2`,{id:`kaivoh-title`,className:`sr-only`,children:`Kai Portal`}),(0,f.jsxs)(p,{children:[(0,f.jsx)(`section`,{className:`portal-pane portal-pane--voh`,style:{display:b===`voh`?`block`:`none`},"aria-hidden":b!==`voh`,children:(0,f.jsx)(d.Suspense,{fallback:(0,f.jsxs)(`div`,{className:`kai-voh-center`,children:[(0,f.jsx)(`div`,{className:`kai-voh-spinner`}),(0,f.jsx)(`div`,{children:`Summoning Vohâ€¦`})]}),children:(0,f.jsx)(h,{})})}),(0,f.jsx)(`section`,{className:`portal-pane portal-pane--realms`,style:{display:b===`realms`?`block`:`none`},"aria-hidden":b!==`realms`,children:O?(0,f.jsx)(d.Suspense,{fallback:(0,f.jsxs)(`div`,{className:`kai-voh-center`,children:[(0,f.jsx)(`div`,{className:`kai-voh-spinner`}),(0,f.jsx)(`div`,{children:`Opening Kai Realmsâ€¦`})]}),children:(0,f.jsx)(g,{onClose:()=>A(`voh`)})}):null})]})]})]})]})]}),document.body):null}export{D as default};