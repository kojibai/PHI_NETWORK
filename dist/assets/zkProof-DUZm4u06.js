function e(e){return typeof e==`object`&&!!e&&Object.keys(e).length>0}async function t(t){let n=t.poseidonHash?.trim(),r=t.secret?.trim();if(!n||!r)return null;try{if(typeof fetch!=`function`)return null;let i=await fetch(`/api/proof/sigil`,{method:`POST`,headers:{"Content-Type":`application/json`},body:JSON.stringify({secret:r,expectedHash:n})});if(!i.ok)throw Error(`ZK proof API failed`);let a=await i.json();if(!a||!e(a))return null;let o=a.zkProof;if(!e(o))throw Error(`ZK proof missing`);let s=Array.isArray(a.zkPublicInputs)?a.zkPublicInputs.map(e=>String(e)):[];if(!s.length)throw Error(`ZK public input missing`);if(s[0]!==n)throw Error(`ZK public input mismatch`);let c={scheme:`groth16-poseidon`,api:`/api/proof/sigil`,explorer:`/keystream/hash/${n}`,...t.proofHints??{},...a.proofHints??{}};return{proof:o??null,proofHints:c,zkPublicInputs:s}}catch{return null}}export{t};